(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerRecord = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerRecord=(()=>{var qr=Object.defineProperty;var Ci=Object.getOwnPropertyDescriptor;var Ni=Object.getOwnPropertyNames;var Di=Object.prototype.hasOwnProperty;var dt=(r,t)=>{for(var e in t)qr(r,e,{get:t[e],enumerable:!0})},_i=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ni(t))!Di.call(r,o)&&o!==e&&qr(r,o,{get:()=>t[o],enumerable:!(n=Ci(t,o))||n.enumerable});return r};var Ki=r=>_i(qr({},"__esModule",{value:!0}),r);var ju={};dt(ju,{PeerRecord:()=>Or,RecordEnvelope:()=>Tr});var Hr=Symbol.for("@libp2p/peer-id");var pt=class extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}},me=class extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}};var Qe=class extends Error{static name="InvalidMultihashError";constructor(t="Invalid Multihash"){super(t),this.name="InvalidMultihashError"}};var ye=class extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}};var Zr={};dt(Zr,{base58btc:()=>W,base58flickr:()=>Vi});var Qu=new Uint8Array(0);function Po(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function Dt(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function Co(r){return new TextEncoder().encode(r)}function No(r){return new TextDecoder().decode(r)}function ki(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var o=0;o<r.length;o++){var s=r.charAt(o),i=s.charCodeAt(0);if(e[i]!==255)throw new TypeError(s+" is ambiguous");e[i]=o}var a=r.length,c=r.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var g=0,h=0,E=0,v=w.length;E!==v&&w[E]===0;)E++,g++;for(var m=(v-E)*u+1>>>0,B=new Uint8Array(m);E!==v;){for(var P=w[E],R=0,I=m-1;(P!==0||R<h)&&I!==-1;I--,R++)P+=256*B[I]>>>0,B[I]=P%a>>>0,P=P/a>>>0;if(P!==0)throw new Error("Non-zero carry");h=R,E++}for(var U=m-h;U!==m&&B[U]===0;)U++;for(var T=c.repeat(g);U<m;++U)T+=r.charAt(B[U]);return T}function p(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var g=0;if(w[g]!==" "){for(var h=0,E=0;w[g]===c;)h++,g++;for(var v=(w.length-g)*f+1>>>0,m=new Uint8Array(v);w[g];){var B=e[w.charCodeAt(g)];if(B===255)return;for(var P=0,R=v-1;(B!==0||P<E)&&R!==-1;R--,P++)B+=a*m[R]>>>0,m[R]=B%256>>>0,B=B/256>>>0;if(B!==0)throw new Error("Non-zero carry");E=P,g++}if(w[g]!==" "){for(var I=v-E;I!==v&&m[I]===0;)I++;for(var U=new Uint8Array(h+(v-I)),T=h;I!==v;)U[T++]=m[I++];return U}}}function x(w){var g=p(w);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:l,decodeUnsafe:p,decode:x}}var Oi=ki,Mi=Oi,_o=Mi;var Vr=class{name;prefix;baseEncode;constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},zr=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,n){this.name=t,this.prefix=e;let o=e.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Ko(this,t)}},Fr=class{decoders;constructor(t){this.decoders=t}or(t){return Ko(this,t)}decode(t){let e=t[0],n=this.decoders[e];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Ko(r,t){return new Fr({...r.decoders??{[r.prefix]:r},...t.decoders??{[t.prefix]:t}})}var Gr=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,n,o){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=o,this.encoder=new Vr(t,e,n),this.decoder=new zr(t,e,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function ge({name:r,prefix:t,encode:e,decode:n}){return new Gr(r,t,e,n)}function Zt({name:r,prefix:t,alphabet:e}){let{encode:n,decode:o}=_o(e,r);return ge({prefix:t,name:r,encode:n,decode:s=>Dt(o(s))})}function qi(r,t,e,n){let o={};for(let u=0;u<t.length;++u)o[t[u]]=u;let s=r.length;for(;r[s-1]==="=";)--s;let i=new Uint8Array(s*e/8|0),a=0,c=0,f=0;for(let u=0;u<s;++u){let l=o[r[u]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<e|l,a+=e,a>=8&&(a-=8,i[f++]=255&c>>a)}if(a>=e||(255&c<<8-a)!==0)throw new SyntaxError("Unexpected end of data");return i}function Hi(r,t,e){let n=t[t.length-1]==="=",o=(1<<e)-1,s="",i=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],i+=8;i>e;)i-=e,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<e-i]),n)for(;(s.length*e&7)!==0;)s+="=";return s}function J({name:r,prefix:t,bitsPerChar:e,alphabet:n}){return ge({prefix:t,name:r,encode(o){return Hi(o,n,e)},decode(o){return qi(o,n,e,r)}})}var W=Zt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vi=Zt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var $r={};dt($r,{base32:()=>_t,base32hex:()=>Zi,base32hexpad:()=>Yi,base32hexpadupper:()=>ji,base32hexupper:()=>$i,base32pad:()=>Fi,base32padupper:()=>Gi,base32upper:()=>zi,base32z:()=>Wi});var _t=J({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),zi=J({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Fi=J({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Gi=J({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Zi=J({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$i=J({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Yi=J({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ji=J({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Wi=J({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Yr={};dt(Yr,{base36:()=>Ne,base36upper:()=>Xi});var Ne=Zt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xi=Zt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ji=Mo,ko=128,Qi=127,ta=~Qi,ea=Math.pow(2,31);function Mo(r,t,e){t=t||[],e=e||0;for(var n=e;r>=ea;)t[e++]=r&255|ko,r/=128;for(;r&ta;)t[e++]=r&255|ko,r>>>=7;return t[e]=r|0,Mo.bytes=e-n+1,t}var ra=jr,na=128,Oo=127;function jr(r,n){var e=0,n=n||0,o=0,s=n,i,a=r.length;do{if(s>=a)throw jr.bytes=0,new RangeError("Could not decode varint");i=r[s++],e+=o<28?(i&Oo)<<o:(i&Oo)*Math.pow(2,o),o+=7}while(i>=na);return jr.bytes=s-n,e}var oa=Math.pow(2,7),sa=Math.pow(2,14),ia=Math.pow(2,21),aa=Math.pow(2,28),ca=Math.pow(2,35),ua=Math.pow(2,42),fa=Math.pow(2,49),la=Math.pow(2,56),ha=Math.pow(2,63),da=function(r){return r<oa?1:r<sa?2:r<ia?3:r<aa?4:r<ca?5:r<ua?6:r<fa?7:r<la?8:r<ha?9:10},pa={encode:Ji,decode:ra,encodingLength:da},ma=pa,De=ma;function _e(r,t=0){return[De.decode(r,t),De.decode.bytes]}function be(r,t,e=0){return De.encode(r,t,e),t}function xe(r){return De.encodingLength(r)}function At(r,t){let e=t.byteLength,n=xe(r),o=n+xe(e),s=new Uint8Array(o+e);return be(r,s,0),be(e,s,n),s.set(t,o),new we(r,e,t,s)}function oe(r){let t=Dt(r),[e,n]=_e(t),[o,s]=_e(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new we(e,o,i,t)}function qo(r,t){if(r===t)return!0;{let e=t;return r.code===e.code&&r.size===e.size&&e.bytes instanceof Uint8Array&&Po(r.bytes,e.bytes)}}var we=class{code;size;digest;bytes;constructor(t,e,n,o){this.code=t,this.size=e,this.digest=n,this.bytes=o}};function Ho(r,t){let{bytes:e,version:n}=r;switch(n){case 0:return ga(e,Wr(r),t??W.encoder);default:return ba(e,Wr(r),t??_t.encoder)}}var Vo=new WeakMap;function Wr(r){let t=Vo.get(r);if(t==null){let e=new Map;return Vo.set(r,e),e}return t}var it=class r{code;version;multihash;bytes;"/";constructor(t,e,n,o){this.code=e,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:e}=this;if(t!==Ke)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==xa)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:e}=this.multihash,n=At(t,e);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return r.equals(this,t)}static equals(t,e){let n=e;return n!=null&&t.code===n.code&&t.version===n.version&&qo(t.multihash,n.multihash)}toString(t){return Ho(this,t)}toJSON(){return{"/":Ho(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let e=t;if(e instanceof r)return e;if(e["/"]!=null&&e["/"]===e.bytes||e.asCID===e){let{version:n,code:o,multihash:s,bytes:i}=e;return new r(n,o,s,i??zo(n,o,s.bytes))}else if(e[wa]===!0){let{version:n,multihash:o,code:s}=e,i=oe(o);return r.create(n,s,i)}else return null}static create(t,e,n){if(typeof e!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(e!==Ke)throw new Error(`Version 0 CID must use dag-pb (code: ${Ke}) block encoding`);return new r(t,e,n,n.bytes)}case 1:{let o=zo(t,e,n.bytes);return new r(t,e,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return r.create(0,Ke,t)}static createV1(t,e){return r.create(1,t,e)}static decode(t){let[e,n]=r.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return e}static decodeFirst(t){let e=r.inspectBytes(t),n=e.size-e.multihashSize,o=Dt(t.subarray(n,n+e.multihashSize));if(o.byteLength!==e.multihashSize)throw new Error("Incorrect length");let s=o.subarray(e.multihashSize-e.digestSize),i=new we(e.multihashCode,e.digestSize,s,o);return[e.version===0?r.createV0(i):r.createV1(e.codec,i),t.subarray(e.size)]}static inspectBytes(t){let e=0,n=()=>{let[l,p]=_e(t.subarray(e));return e+=p,l},o=n(),s=Ke;if(o===18?(o=0,e=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=e,a=n(),c=n(),f=e+c,u=f-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(t,e){let[n,o]=ya(t,e),s=r.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Wr(s).set(n,t),s}};function ya(r,t){switch(r[0]){case"Q":{let e=t??W;return[W.prefix,e.decode(`${W.prefix}${r}`)]}case W.prefix:{let e=t??W;return[W.prefix,e.decode(r)]}case _t.prefix:{let e=t??_t;return[_t.prefix,e.decode(r)]}case Ne.prefix:{let e=t??Ne;return[Ne.prefix,e.decode(r)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],t.decode(r)]}}}function ga(r,t,e){let{prefix:n}=e;if(n!==W.prefix)throw Error(`Cannot string encode V0 in ${e.name} encoding`);let o=t.get(n);if(o==null){let s=e.encode(r).slice(1);return t.set(n,s),s}else return o}function ba(r,t,e){let{prefix:n}=e,o=t.get(n);if(o==null){let s=e.encode(r);return t.set(n,s),s}else return o}var Ke=112,xa=18;function zo(r,t,e){let n=xe(r),o=n+xe(t),s=new Uint8Array(o+e.byteLength);return be(r,s,0),be(t,s,n),s.set(e,o),s}var wa=Symbol.for("@ipld/js-cid/CID");var Xr={};dt(Xr,{identity:()=>Kt});var Fo=0,Ea="identity",Go=Dt;function Sa(r){return At(Fo,Go(r))}var Kt={code:Fo,name:Ea,encode:Go,digest:Sa};function ut(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function Zo(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function va(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Ee(r,...t){if(!va(r))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(r.length))throw new Error("Uint8Array expected of length "+t+", got length="+r.length)}function $o(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Zo(r.outputLen),Zo(r.blockLen)}function Se(r,t=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(t&&r.finished)throw new Error("Hash#digest() has already been called")}function Yo(r,t){Ee(r);let e=t.outputLen;if(r.length<e)throw new Error("digestInto() expects output buffer of length at least "+e)}var se=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function er(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Bt(r,t){return r<<32-t|r>>>t}function jo(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function ke(r){return typeof r=="string"&&(r=jo(r)),Ee(r),r}function Jr(...r){let t=0;for(let n=0;n<r.length;n++){let o=r[n];Ee(o),t+=o.length}let e=new Uint8Array(t);for(let n=0,o=0;n<r.length;n++){let s=r[n];e.set(s,o),o+=s.length}return e}var ve=class{clone(){return this._cloneInto()}};function rr(r){let t=n=>r().update(ke(n)).digest(),e=r();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>r(),t}function nr(r=32){if(se&&typeof se.getRandomValues=="function")return se.getRandomValues(new Uint8Array(r));if(se&&typeof se.randomBytes=="function")return se.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function Aa(r,t,e,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(t,e,n);let o=BigInt(32),s=BigInt(4294967295),i=Number(e>>o&s),a=Number(e&s),c=n?4:0,f=n?0:4;r.setUint32(t+c,i,n),r.setUint32(t+f,a,n)}function Wo(r,t,e){return r&t^~r&e}function Xo(r,t,e){return r&t^r&e^t&e}var Ae=class extends ve{constructor(t,e,n,o){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=er(this.buffer)}update(t){Se(this);let{view:e,buffer:n,blockLen:o}=this;t=ke(t);let s=t.length;for(let i=0;i<s;){let a=Math.min(o-this.pos,s-i);if(a===o){let c=er(t);for(;o<=s-i;i+=o)this.process(c,i);continue}n.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===o&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Se(this),Yo(t,this),this.finished=!0;let{buffer:e,view:n,blockLen:o,isLE:s}=this,{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(n,0),i=0);for(let l=i;l<o;l++)e[l]=0;Aa(n,o-8,BigInt(this.length*8),s),this.process(n,0);let a=er(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)a.setUint32(4*l,u[l],s)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:n,length:o,finished:s,destroyed:i,pos:a}=this;return t.length=o,t.pos=a,t.finished=s,t.destroyed=i,o%e&&t.buffer.set(n),t}};var or=BigInt(4294967295),Qr=BigInt(32);function Jo(r,t=!1){return t?{h:Number(r&or),l:Number(r>>Qr&or)}:{h:Number(r>>Qr&or)|0,l:Number(r&or)|0}}function Ba(r,t=!1){let e=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let o=0;o<r.length;o++){let{h:s,l:i}=Jo(r[o],t);[e[o],n[o]]=[s,i]}return[e,n]}var Ia=(r,t)=>BigInt(r>>>0)<<Qr|BigInt(t>>>0),Ta=(r,t,e)=>r>>>e,La=(r,t,e)=>r<<32-e|t>>>e,Ua=(r,t,e)=>r>>>e|t<<32-e,Ra=(r,t,e)=>r<<32-e|t>>>e,Pa=(r,t,e)=>r<<64-e|t>>>e-32,Ca=(r,t,e)=>r>>>e-32|t<<64-e,Na=(r,t)=>t,Da=(r,t)=>r,_a=(r,t,e)=>r<<e|t>>>32-e,Ka=(r,t,e)=>t<<e|r>>>32-e,ka=(r,t,e)=>t<<e-32|r>>>64-e,Oa=(r,t,e)=>r<<e-32|t>>>64-e;function Ma(r,t,e,n){let o=(t>>>0)+(n>>>0);return{h:r+e+(o/2**32|0)|0,l:o|0}}var qa=(r,t,e)=>(r>>>0)+(t>>>0)+(e>>>0),Ha=(r,t,e,n)=>t+e+n+(r/2**32|0)|0,Va=(r,t,e,n)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0),za=(r,t,e,n,o)=>t+e+n+o+(r/2**32|0)|0,Fa=(r,t,e,n,o)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0)+(o>>>0),Ga=(r,t,e,n,o,s)=>t+e+n+o+s+(r/2**32|0)|0;var Za={fromBig:Jo,split:Ba,toBig:Ia,shrSH:Ta,shrSL:La,rotrSH:Ua,rotrSL:Ra,rotrBH:Pa,rotrBL:Ca,rotr32H:Na,rotr32L:Da,rotlSH:_a,rotlSL:Ka,rotlBH:ka,rotlBL:Oa,add:Ma,add3L:qa,add3H:Ha,add4L:Va,add4H:za,add5H:Ga,add5L:Fa},_=Za;var[$a,Ya]=_.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Yt=new Uint32Array(80),jt=new Uint32Array(80),tn=class extends Ae{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:e,Bh:n,Bl:o,Ch:s,Cl:i,Dh:a,Dl:c,Eh:f,El:u,Fh:l,Fl:p,Gh:x,Gl:w,Hh:g,Hl:h}=this;return[t,e,n,o,s,i,a,c,f,u,l,p,x,w,g,h]}set(t,e,n,o,s,i,a,c,f,u,l,p,x,w,g,h){this.Ah=t|0,this.Al=e|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=l|0,this.Fl=p|0,this.Gh=x|0,this.Gl=w|0,this.Hh=g|0,this.Hl=h|0}process(t,e){for(let m=0;m<16;m++,e+=4)Yt[m]=t.getUint32(e),jt[m]=t.getUint32(e+=4);for(let m=16;m<80;m++){let B=Yt[m-15]|0,P=jt[m-15]|0,R=_.rotrSH(B,P,1)^_.rotrSH(B,P,8)^_.shrSH(B,P,7),I=_.rotrSL(B,P,1)^_.rotrSL(B,P,8)^_.shrSL(B,P,7),U=Yt[m-2]|0,T=jt[m-2]|0,Z=_.rotrSH(U,T,19)^_.rotrBH(U,T,61)^_.shrSH(U,T,6),M=_.rotrSL(U,T,19)^_.rotrBL(U,T,61)^_.shrSL(U,T,6),k=_.add4L(I,M,jt[m-7],jt[m-16]),Q=_.add4H(k,R,Z,Yt[m-7],Yt[m-16]);Yt[m]=Q|0,jt[m]=k|0}let{Ah:n,Al:o,Bh:s,Bl:i,Ch:a,Cl:c,Dh:f,Dl:u,Eh:l,El:p,Fh:x,Fl:w,Gh:g,Gl:h,Hh:E,Hl:v}=this;for(let m=0;m<80;m++){let B=_.rotrSH(l,p,14)^_.rotrSH(l,p,18)^_.rotrBH(l,p,41),P=_.rotrSL(l,p,14)^_.rotrSL(l,p,18)^_.rotrBL(l,p,41),R=l&x^~l&g,I=p&w^~p&h,U=_.add5L(v,P,I,Ya[m],jt[m]),T=_.add5H(U,E,B,R,$a[m],Yt[m]),Z=U|0,M=_.rotrSH(n,o,28)^_.rotrBH(n,o,34)^_.rotrBH(n,o,39),k=_.rotrSL(n,o,28)^_.rotrBL(n,o,34)^_.rotrBL(n,o,39),Q=n&s^n&a^s&a,S=o&i^o&c^i&c;E=g|0,v=h|0,g=x|0,h=w|0,x=l|0,w=p|0,{h:l,l:p}=_.add(f|0,u|0,T|0,Z|0),f=a|0,u=c|0,a=s|0,c=i|0,s=n|0,i=o|0;let L=_.add3L(Z,k,S);n=_.add3H(L,T,M,Q),o=L|0}({h:n,l:o}=_.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:i}=_.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:a,l:c}=_.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=_.add(this.Dh|0,this.Dl|0,f|0,u|0),{h:l,l:p}=_.add(this.Eh|0,this.El|0,l|0,p|0),{h:x,l:w}=_.add(this.Fh|0,this.Fl|0,x|0,w|0),{h:g,l:h}=_.add(this.Gh|0,this.Gl|0,g|0,h|0),{h:E,l:v}=_.add(this.Hh|0,this.Hl|0,E|0,v|0),this.set(n,o,s,i,a,c,f,u,l,p,x,w,g,h,E,v)}roundClean(){Yt.fill(0),jt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Qo=rr(()=>new tn);var ar={};dt(ar,{aInRange:()=>yt,abool:()=>It,abytes:()=>Be,bitGet:()=>tc,bitLen:()=>on,bitMask:()=>Me,bitSet:()=>ec,bytesToHex:()=>Ot,bytesToNumberBE:()=>Mt,bytesToNumberLE:()=>Xt,concatBytes:()=>qt,createHmacDrbg:()=>sn,ensureBytes:()=>X,equalBytes:()=>Ja,hexToBytes:()=>ae,hexToNumber:()=>nn,inRange:()=>Oe,isBytes:()=>Wt,memoized:()=>ue,notImplemented:()=>nc,numberToBytesBE:()=>Jt,numberToBytesLE:()=>ce,numberToHexUnpadded:()=>ie,numberToVarBytesBE:()=>Xa,utf8ToBytes:()=>Qa,validateObject:()=>Rt});var sr=BigInt(0),ir=BigInt(1),ja=BigInt(2);function Wt(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Be(r){if(!Wt(r))throw new Error("Uint8Array expected")}function It(r,t){if(typeof t!="boolean")throw new Error(r+" boolean expected, got "+t)}var Wa=Array.from({length:256},(r,t)=>t.toString(16).padStart(2,"0"));function Ot(r){Be(r);let t="";for(let e=0;e<r.length;e++)t+=Wa[r[e]];return t}function ie(r){let t=r.toString(16);return t.length&1?"0"+t:t}function nn(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?sr:BigInt("0x"+r)}var kt={_0:48,_9:57,A:65,F:70,a:97,f:102};function ts(r){if(r>=kt._0&&r<=kt._9)return r-kt._0;if(r>=kt.A&&r<=kt.F)return r-(kt.A-10);if(r>=kt.a&&r<=kt.f)return r-(kt.a-10)}function ae(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);let t=r.length,e=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(e);for(let o=0,s=0;o<e;o++,s+=2){let i=ts(r.charCodeAt(s)),a=ts(r.charCodeAt(s+1));if(i===void 0||a===void 0){let c=r[s]+r[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[o]=i*16+a}return n}function Mt(r){return nn(Ot(r))}function Xt(r){return Be(r),nn(Ot(Uint8Array.from(r).reverse()))}function Jt(r,t){return ae(r.toString(16).padStart(t*2,"0"))}function ce(r,t){return Jt(r,t).reverse()}function Xa(r){return ae(ie(r))}function X(r,t,e){let n;if(typeof t=="string")try{n=ae(t)}catch(s){throw new Error(r+" must be hex string or Uint8Array, cause: "+s)}else if(Wt(t))n=Uint8Array.from(t);else throw new Error(r+" must be hex string or Uint8Array");let o=n.length;if(typeof e=="number"&&o!==e)throw new Error(r+" of length "+e+" expected, got "+o);return n}function qt(...r){let t=0;for(let n=0;n<r.length;n++){let o=r[n];Be(o),t+=o.length}let e=new Uint8Array(t);for(let n=0,o=0;n<r.length;n++){let s=r[n];e.set(s,o),o+=s.length}return e}function Ja(r,t){if(r.length!==t.length)return!1;let e=0;for(let n=0;n<r.length;n++)e|=r[n]^t[n];return e===0}function Qa(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}var en=r=>typeof r=="bigint"&&sr<=r;function Oe(r,t,e){return en(r)&&en(t)&&en(e)&&t<=r&&r<e}function yt(r,t,e,n){if(!Oe(t,e,n))throw new Error("expected valid "+r+": "+e+" <= n < "+n+", got "+t)}function on(r){let t;for(t=0;r>sr;r>>=ir,t+=1);return t}function tc(r,t){return r>>BigInt(t)&ir}function ec(r,t,e){return r|(e?ir:sr)<<BigInt(t)}var Me=r=>(ja<<BigInt(r-1))-ir,rn=r=>new Uint8Array(r),es=r=>Uint8Array.from(r);function sn(r,t,e){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let n=rn(r),o=rn(r),s=0,i=()=>{n.fill(1),o.fill(0),s=0},a=(...l)=>e(o,n,...l),c=(l=rn())=>{o=a(es([0]),l),n=a(),l.length!==0&&(o=a(es([1]),l),n=a())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,p=[];for(;l<t;){n=a();let x=n.slice();p.push(x),l+=n.length}return qt(...p)};return(l,p)=>{i(),c(l);let x;for(;!(x=p(f()));)c();return i(),x}}var rc={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Wt(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,t)=>t.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Rt(r,t,e={}){let n=(o,s,i)=>{let a=rc[s];if(typeof a!="function")throw new Error("invalid validator function");let c=r[o];if(!(i&&c===void 0)&&!a(c,r))throw new Error("param "+String(o)+" is invalid. Expected "+s+", got "+c)};for(let[o,s]of Object.entries(t))n(o,s,!1);for(let[o,s]of Object.entries(e))n(o,s,!0);return r}var nc=()=>{throw new Error("not implemented")};function ue(r){let t=new WeakMap;return(e,...n)=>{let o=t.get(e);if(o!==void 0)return o;let s=r(e,...n);return t.set(e,s),s}}var tt=BigInt(0),$=BigInt(1),fe=BigInt(2),oc=BigInt(3),an=BigInt(4),rs=BigInt(5),ns=BigInt(8),sc=BigInt(9),ic=BigInt(16);function z(r,t){let e=r%t;return e>=tt?e:t+e}function ac(r,t,e){if(t<tt)throw new Error("invalid exponent, negatives unsupported");if(e<=tt)throw new Error("invalid modulus");if(e===$)return tt;let n=$;for(;t>tt;)t&$&&(n=n*r%e),r=r*r%e,t>>=$;return n}function Y(r,t,e){let n=r;for(;t-- >tt;)n*=n,n%=e;return n}function cr(r,t){if(r===tt)throw new Error("invert: expected non-zero number");if(t<=tt)throw new Error("invert: expected positive modulus, got "+t);let e=z(r,t),n=t,o=tt,s=$,i=$,a=tt;for(;e!==tt;){let f=n/e,u=n%e,l=o-i*f,p=s-a*f;n=e,e=u,o=i,s=a,i=l,a=p}if(n!==$)throw new Error("invert: does not exist");return z(o,t)}function cc(r){let t=(r-$)/fe,e,n,o;for(e=r-$,n=0;e%fe===tt;e/=fe,n++);for(o=fe;o<r&&ac(o,t,r)!==r-$;o++)if(o>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){let i=(r+$)/an;return function(c,f){let u=c.pow(f,i);if(!c.eql(c.sqr(u),f))throw new Error("Cannot find square root");return u}}let s=(e+$)/fe;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=n,u=a.pow(a.mul(a.ONE,o),e),l=a.pow(c,s),p=a.pow(c,e);for(;!a.eql(p,a.ONE);){if(a.eql(p,a.ZERO))return a.ZERO;let x=1;for(let g=a.sqr(p);x<f&&!a.eql(g,a.ONE);x++)g=a.sqr(g);let w=a.pow(u,$<<BigInt(f-x-1));u=a.sqr(w),l=a.mul(l,w),p=a.mul(p,u),f=x}return l}}function uc(r){if(r%an===oc){let t=(r+$)/an;return function(n,o){let s=n.pow(o,t);if(!n.eql(n.sqr(s),o))throw new Error("Cannot find square root");return s}}if(r%ns===rs){let t=(r-rs)/ns;return function(n,o){let s=n.mul(o,fe),i=n.pow(s,t),a=n.mul(o,i),c=n.mul(n.mul(a,fe),i),f=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),o))throw new Error("Cannot find square root");return f}}return r%ic,cc(r)}var os=(r,t)=>(z(r,t)&$)===$,fc=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function cn(r){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=fc.reduce((n,o)=>(n[o]="function",n),t);return Rt(r,e)}function lc(r,t,e){if(e<tt)throw new Error("invalid exponent, negatives unsupported");if(e===tt)return r.ONE;if(e===$)return t;let n=r.ONE,o=t;for(;e>tt;)e&$&&(n=r.mul(n,o)),o=r.sqr(o),e>>=$;return n}function hc(r,t){let e=new Array(t.length),n=t.reduce((s,i,a)=>r.is0(i)?s:(e[a]=s,r.mul(s,i)),r.ONE),o=r.inv(n);return t.reduceRight((s,i,a)=>r.is0(i)?s:(e[a]=r.mul(s,e[a]),r.mul(s,i)),o),e}function un(r,t){let e=t!==void 0?t:r.toString(2).length,n=Math.ceil(e/8);return{nBitLength:e,nByteLength:n}}function Qt(r,t,e=!1,n={}){if(r<=tt)throw new Error("invalid field: expected ORDER > 0, got "+r);let{nBitLength:o,nByteLength:s}=un(r,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let i,a=Object.freeze({ORDER:r,isLE:e,BITS:o,BYTES:s,MASK:Me(o),ZERO:tt,ONE:$,create:c=>z(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return tt<=c&&c<r},is0:c=>c===tt,isOdd:c=>(c&$)===$,neg:c=>z(-c,r),eql:(c,f)=>c===f,sqr:c=>z(c*c,r),add:(c,f)=>z(c+f,r),sub:(c,f)=>z(c-f,r),mul:(c,f)=>z(c*f,r),pow:(c,f)=>lc(a,c,f),div:(c,f)=>z(c*cr(f,r),r),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>cr(c,r),sqrt:n.sqrt||(c=>(i||(i=uc(r)),i(a,c))),invertBatch:c=>hc(a,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>e?ce(c,s):Jt(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return e?Xt(c):Mt(c)}});return Object.freeze(a)}function ss(r){if(typeof r!="bigint")throw new Error("field order must be bigint");let t=r.toString(2).length;return Math.ceil(t/8)}function fn(r){let t=ss(r);return t+Math.ceil(t/2)}function is(r,t,e=!1){let n=r.length,o=ss(t),s=fn(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);let i=e?Xt(r):Mt(r),a=z(i,t-$)+$;return e?ce(a,o):Jt(a,o)}var as=BigInt(0),ur=BigInt(1);function ln(r,t){let e=t.negate();return r?e:t}function cs(r,t){if(!Number.isSafeInteger(r)||r<=0||r>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+r)}function hn(r,t){cs(r,t);let e=Math.ceil(t/r)+1,n=2**(r-1);return{windows:e,windowSize:n}}function dc(r,t){if(!Array.isArray(r))throw new Error("array expected");r.forEach((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)})}function pc(r,t){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}var dn=new WeakMap,us=new WeakMap;function pn(r){return us.get(r)||1}function fr(r,t){return{constTimeNegate:ln,hasPrecomputes(e){return pn(e)!==1},unsafeLadder(e,n,o=r.ZERO){let s=e;for(;n>as;)n&ur&&(o=o.add(s)),s=s.double(),n>>=ur;return o},precomputeWindow(e,n){let{windows:o,windowSize:s}=hn(n,t),i=[],a=e,c=a;for(let f=0;f<o;f++){c=a,i.push(c);for(let u=1;u<s;u++)c=c.add(a),i.push(c);a=c.double()}return i},wNAF(e,n,o){let{windows:s,windowSize:i}=hn(e,t),a=r.ZERO,c=r.BASE,f=BigInt(2**e-1),u=2**e,l=BigInt(e);for(let p=0;p<s;p++){let x=p*i,w=Number(o&f);o>>=l,w>i&&(w-=u,o+=ur);let g=x,h=x+Math.abs(w)-1,E=p%2!==0,v=w<0;w===0?c=c.add(ln(E,n[g])):a=a.add(ln(v,n[h]))}return{p:a,f:c}},wNAFUnsafe(e,n,o,s=r.ZERO){let{windows:i,windowSize:a}=hn(e,t),c=BigInt(2**e-1),f=2**e,u=BigInt(e);for(let l=0;l<i;l++){let p=l*a;if(o===as)break;let x=Number(o&c);if(o>>=u,x>a&&(x-=f,o+=ur),x===0)continue;let w=n[p+Math.abs(x)-1];x<0&&(w=w.negate()),s=s.add(w)}return s},getPrecomputes(e,n,o){let s=dn.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&dn.set(n,o(s))),s},wNAFCached(e,n,o){let s=pn(e);return this.wNAF(s,this.getPrecomputes(s,e,o),n)},wNAFCachedUnsafe(e,n,o,s){let i=pn(e);return i===1?this.unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,o),n,s)},setWindowSize(e,n){cs(n,t),us.set(e,n),dn.delete(e)}}}function lr(r,t,e,n){if(dc(e,r),pc(n,t),e.length!==n.length)throw new Error("arrays of points and scalars must have equal length");let o=r.ZERO,s=on(BigInt(e.length)),i=s>12?s-3:s>4?s-2:s?2:1,a=(1<<i)-1,c=new Array(a+1).fill(o),f=Math.floor((t.BITS-1)/i)*i,u=o;for(let l=f;l>=0;l-=i){c.fill(o);for(let x=0;x<n.length;x++){let w=n[x],g=Number(w>>BigInt(l)&BigInt(a));c[g]=c[g].add(e[x])}let p=o;for(let x=c.length-1,w=o;x>0;x--)w=w.add(c[x]),p=p.add(w);if(u=u.add(p),l!==0)for(let x=0;x<i;x++)u=u.double()}return u}function qe(r){return cn(r.Fp),Rt(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...un(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}var Tt=BigInt(0),gt=BigInt(1),hr=BigInt(2),mc=BigInt(8),yc={zip215:!0};function gc(r){let t=qe(r);return Rt(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function fs(r){let t=gc(r),{Fp:e,n,prehash:o,hash:s,randomBytes:i,nByteLength:a,h:c}=t,f=hr<<BigInt(a*8)-gt,u=e.create,l=Qt(t.n,t.nBitLength),p=t.uvRatio||((y,d)=>{try{return{isValid:!0,value:e.sqrt(y*e.inv(d))}}catch{return{isValid:!1,value:Tt}}}),x=t.adjustScalarBytes||(y=>y),w=t.domain||((y,d,b)=>{if(It("phflag",b),d.length||b)throw new Error("Contexts/pre-hash are not supported");return y});function g(y,d){yt("coordinate "+y,d,Tt,f)}function h(y){if(!(y instanceof m))throw new Error("ExtendedPoint expected")}let E=ue((y,d)=>{let{ex:b,ey:A,ez:C}=y,N=y.is0();d==null&&(d=N?mc:e.inv(C));let K=u(b*d),O=u(A*d),D=u(C*d);if(N)return{x:Tt,y:gt};if(D!==gt)throw new Error("invZ was invalid");return{x:K,y:O}}),v=ue(y=>{let{a:d,d:b}=t;if(y.is0())throw new Error("bad point: ZERO");let{ex:A,ey:C,ez:N,et:K}=y,O=u(A*A),D=u(C*C),V=u(N*N),G=u(V*V),rt=u(O*d),nt=u(V*u(rt+D)),st=u(G+u(b*u(O*D)));if(nt!==st)throw new Error("bad point: equation left != right (1)");let ct=u(A*C),mt=u(N*K);if(ct!==mt)throw new Error("bad point: equation left != right (2)");return!0});class m{constructor(d,b,A,C){this.ex=d,this.ey=b,this.ez=A,this.et=C,g("x",d),g("y",b),g("z",A),g("t",C),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(d){if(d instanceof m)throw new Error("extended point not allowed");let{x:b,y:A}=d||{};return g("x",b),g("y",A),new m(b,A,gt,u(b*A))}static normalizeZ(d){let b=e.invertBatch(d.map(A=>A.ez));return d.map((A,C)=>A.toAffine(b[C])).map(m.fromAffine)}static msm(d,b){return lr(m,l,d,b)}_setWindowSize(d){R.setWindowSize(this,d)}assertValidity(){v(this)}equals(d){h(d);let{ex:b,ey:A,ez:C}=this,{ex:N,ey:K,ez:O}=d,D=u(b*O),V=u(N*C),G=u(A*O),rt=u(K*C);return D===V&&G===rt}is0(){return this.equals(m.ZERO)}negate(){return new m(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:d}=t,{ex:b,ey:A,ez:C}=this,N=u(b*b),K=u(A*A),O=u(hr*u(C*C)),D=u(d*N),V=b+A,G=u(u(V*V)-N-K),rt=D+K,nt=rt-O,st=D-K,ct=u(G*nt),mt=u(rt*st),ht=u(G*st),Ut=u(nt*rt);return new m(ct,mt,Ut,ht)}add(d){h(d);let{a:b,d:A}=t,{ex:C,ey:N,ez:K,et:O}=this,{ex:D,ey:V,ez:G,et:rt}=d;if(b===BigInt(-1)){let Ao=u((N-C)*(V+D)),Bo=u((N+C)*(V-D)),Mr=u(Bo-Ao);if(Mr===Tt)return this.double();let Io=u(K*hr*rt),To=u(O*hr*G),Lo=To+Io,Uo=Bo+Ao,Ro=To-Io,Li=u(Lo*Mr),Ui=u(Uo*Ro),Ri=u(Lo*Ro),Pi=u(Mr*Uo);return new m(Li,Ui,Pi,Ri)}let nt=u(C*D),st=u(N*V),ct=u(O*A*rt),mt=u(K*G),ht=u((C+N)*(D+V)-nt-st),Ut=mt-ct,Nt=mt+ct,Ce=u(st-b*nt),Ai=u(ht*Ut),Bi=u(Nt*Ce),Ii=u(ht*Ce),Ti=u(Ut*Nt);return new m(Ai,Bi,Ti,Ii)}subtract(d){return this.add(d.negate())}wNAF(d){return R.wNAFCached(this,d,m.normalizeZ)}multiply(d){let b=d;yt("scalar",b,gt,n);let{p:A,f:C}=this.wNAF(b);return m.normalizeZ([A,C])[0]}multiplyUnsafe(d,b=m.ZERO){let A=d;return yt("scalar",A,Tt,n),A===Tt?P:this.is0()||A===gt?this:R.wNAFCachedUnsafe(this,A,m.normalizeZ,b)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return R.unsafeLadder(this,n).is0()}toAffine(d){return E(this,d)}clearCofactor(){let{h:d}=t;return d===gt?this:this.multiplyUnsafe(d)}static fromHex(d,b=!1){let{d:A,a:C}=t,N=e.BYTES;d=X("pointHex",d,N),It("zip215",b);let K=d.slice(),O=d[N-1];K[N-1]=O&-129;let D=Xt(K),V=b?f:e.ORDER;yt("pointHex.y",D,Tt,V);let G=u(D*D),rt=u(G-gt),nt=u(A*G-C),{isValid:st,value:ct}=p(rt,nt);if(!st)throw new Error("Point.fromHex: invalid y coordinate");let mt=(ct&gt)===gt,ht=(O&128)!==0;if(!b&&ct===Tt&&ht)throw new Error("Point.fromHex: x=0 and x_0=1");return ht!==mt&&(ct=u(-ct)),m.fromAffine({x:ct,y:D})}static fromPrivateKey(d){return T(d).point}toRawBytes(){let{x:d,y:b}=this.toAffine(),A=ce(b,e.BYTES);return A[A.length-1]|=d&gt?128:0,A}toHex(){return Ot(this.toRawBytes())}}m.BASE=new m(t.Gx,t.Gy,gt,u(t.Gx*t.Gy)),m.ZERO=new m(Tt,gt,gt,Tt);let{BASE:B,ZERO:P}=m,R=fr(m,a*8);function I(y){return z(y,n)}function U(y){return I(Xt(y))}function T(y){let d=e.BYTES;y=X("private key",y,d);let b=X("hashed private key",s(y),2*d),A=x(b.slice(0,d)),C=b.slice(d,2*d),N=U(A),K=B.multiply(N),O=K.toRawBytes();return{head:A,prefix:C,scalar:N,point:K,pointBytes:O}}function Z(y){return T(y).pointBytes}function M(y=new Uint8Array,...d){let b=qt(...d);return U(s(w(b,X("context",y),!!o)))}function k(y,d,b={}){y=X("message",y),o&&(y=o(y));let{prefix:A,scalar:C,pointBytes:N}=T(d),K=M(b.context,A,y),O=B.multiply(K).toRawBytes(),D=M(b.context,O,N,y),V=I(K+D*C);yt("signature.s",V,Tt,n);let G=qt(O,ce(V,e.BYTES));return X("result",G,e.BYTES*2)}let Q=yc;function S(y,d,b,A=Q){let{context:C,zip215:N}=A,K=e.BYTES;y=X("signature",y,2*K),d=X("message",d),b=X("publicKey",b,K),N!==void 0&&It("zip215",N),o&&(d=o(d));let O=Xt(y.slice(K,2*K)),D,V,G;try{D=m.fromHex(b,N),V=m.fromHex(y.slice(0,K),N),G=B.multiplyUnsafe(O)}catch{return!1}if(!N&&D.isSmallOrder())return!1;let rt=M(C,V.toRawBytes(),D.toRawBytes(),d);return V.add(D.multiplyUnsafe(rt)).subtract(G).clearCofactor().equals(m.ZERO)}return B._setWindowSize(8),{CURVE:t,getPublicKey:Z,sign:k,verify:S,ExtendedPoint:m,utils:{getExtendedPublicKey:T,randomPrivateKey:()=>i(e.BYTES),precompute(y=8,d=m.BASE){return d._setWindowSize(y),d.multiply(BigInt(3)),d}}}}var mn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ls=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Zf=BigInt(0),bc=BigInt(1),hs=BigInt(2),$f=BigInt(3),xc=BigInt(5),wc=BigInt(8);function Ec(r){let t=BigInt(10),e=BigInt(20),n=BigInt(40),o=BigInt(80),s=mn,a=r*r%s*r%s,c=Y(a,hs,s)*a%s,f=Y(c,bc,s)*r%s,u=Y(f,xc,s)*f%s,l=Y(u,t,s)*u%s,p=Y(l,e,s)*l%s,x=Y(p,n,s)*p%s,w=Y(x,o,s)*x%s,g=Y(w,o,s)*x%s,h=Y(g,t,s)*u%s;return{pow_p_5_8:Y(h,hs,s)*r%s,b2:a}}function Sc(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function vc(r,t){let e=mn,n=z(t*t*t,e),o=z(n*n*t,e),s=Ec(r*o).pow_p_5_8,i=z(r*n*s,e),a=z(t*i*i,e),c=i,f=z(i*ls,e),u=a===r,l=a===z(-r,e),p=a===z(-r*ls,e);return u&&(i=c),(l||p)&&(i=f),os(i,e)&&(i=z(-i,e)),{isValid:u||l,value:i}}var Ac=Qt(mn,void 0,!0),Bc={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ac,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:wc,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Qo,randomBytes:nr,adjustScalarBytes:Sc,uvRatio:vc},ds=fs(Bc);var dr=32;function ps(r,t,e){return ds.verify(t,e instanceof Uint8Array?e:e.subarray(),r)}var pr=class{type="Ed25519";raw;constructor(t){this.raw=yn(t,dr)}toMultihash(){return Kt.digest(Ie(this))}toCID(){return it.createV1(114,this.toMultihash())}toString(){return W.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ut(this.raw,t.raw)}verify(t,e){return ps(this.raw,e,t)}};function gn(r){return r=yn(r,dr),new pr(r)}function yn(r,t){if(r=Uint8Array.from(r??[]),r.length!==t)throw new pt(`Key must be a Uint8Array of length ${t}, got ${r.length}`);return r}function at(r=0){return new Uint8Array(r)}function bt(r=0){return new Uint8Array(r)}var Tc=Math.pow(2,7),Lc=Math.pow(2,14),Uc=Math.pow(2,21),bn=Math.pow(2,28),xn=Math.pow(2,35),wn=Math.pow(2,42),En=Math.pow(2,49),q=128,ft=127;function xt(r){if(r<Tc)return 1;if(r<Lc)return 2;if(r<Uc)return 3;if(r<bn)return 4;if(r<xn)return 5;if(r<wn)return 6;if(r<En)return 7;if(Number.MAX_SAFE_INTEGER!=null&&r>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Sn(r,t,e=0){switch(xt(r)){case 8:t[e++]=r&255|q,r/=128;case 7:t[e++]=r&255|q,r/=128;case 6:t[e++]=r&255|q,r/=128;case 5:t[e++]=r&255|q,r/=128;case 4:t[e++]=r&255|q,r>>>=7;case 3:t[e++]=r&255|q,r>>>=7;case 2:t[e++]=r&255|q,r>>>=7;case 1:{t[e++]=r&255,r>>>=7;break}default:throw new Error("unreachable")}return t}function Rc(r,t,e=0){switch(xt(r)){case 8:t.set(e++,r&255|q),r/=128;case 7:t.set(e++,r&255|q),r/=128;case 6:t.set(e++,r&255|q),r/=128;case 5:t.set(e++,r&255|q),r/=128;case 4:t.set(e++,r&255|q),r>>>=7;case 3:t.set(e++,r&255|q),r>>>=7;case 2:t.set(e++,r&255|q),r>>>=7;case 1:{t.set(e++,r&255),r>>>=7;break}default:throw new Error("unreachable")}return t}function vn(r,t){let e=r[t],n=0;if(n+=e&ft,e<q||(e=r[t+1],n+=(e&ft)<<7,e<q)||(e=r[t+2],n+=(e&ft)<<14,e<q)||(e=r[t+3],n+=(e&ft)<<21,e<q)||(e=r[t+4],n+=(e&ft)*bn,e<q)||(e=r[t+5],n+=(e&ft)*xn,e<q)||(e=r[t+6],n+=(e&ft)*wn,e<q)||(e=r[t+7],n+=(e&ft)*En,e<q))return n;throw new RangeError("Could not decode varint")}function Pc(r,t){let e=r.get(t),n=0;if(n+=e&ft,e<q||(e=r.get(t+1),n+=(e&ft)<<7,e<q)||(e=r.get(t+2),n+=(e&ft)<<14,e<q)||(e=r.get(t+3),n+=(e&ft)<<21,e<q)||(e=r.get(t+4),n+=(e&ft)*bn,e<q)||(e=r.get(t+5),n+=(e&ft)*xn,e<q)||(e=r.get(t+6),n+=(e&ft)*wn,e<q)||(e=r.get(t+7),n+=(e&ft)*En,e<q))return n;throw new RangeError("Could not decode varint")}function Pt(r,t,e=0){return t==null&&(t=bt(xt(r))),t instanceof Uint8Array?Sn(r,t,e):Rc(r,t,e)}function le(r,t=0){return r instanceof Uint8Array?vn(r,t):Pc(r,t)}var Bn=new Float32Array([-0]),te=new Uint8Array(Bn.buffer);function ys(r,t,e){Bn[0]=r,t[e]=te[0],t[e+1]=te[1],t[e+2]=te[2],t[e+3]=te[3]}function gs(r,t){return te[0]=r[t],te[1]=r[t+1],te[2]=r[t+2],te[3]=r[t+3],Bn[0]}var In=new Float64Array([-0]),lt=new Uint8Array(In.buffer);function bs(r,t,e){In[0]=r,t[e]=lt[0],t[e+1]=lt[1],t[e+2]=lt[2],t[e+3]=lt[3],t[e+4]=lt[4],t[e+5]=lt[5],t[e+6]=lt[6],t[e+7]=lt[7]}function xs(r,t){return lt[0]=r[t],lt[1]=r[t+1],lt[2]=r[t+2],lt[3]=r[t+3],lt[4]=r[t+4],lt[5]=r[t+5],lt[6]=r[t+6],lt[7]=r[t+7],In[0]}var Cc=BigInt(Number.MAX_SAFE_INTEGER),Nc=BigInt(Number.MIN_SAFE_INTEGER),wt=class r{lo;hi;constructor(t,e){this.lo=t|0,this.hi=e|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(e+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(BigInt(e)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?e===0?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return he;if(t<Cc&&t>Nc)return this.fromNumber(Number(t));let e=t<0n;e&&(t=-t);let n=t>>32n,o=t-(n<<32n);return e&&(n=~n|0n,o=~o|0n,++o>ws&&(o=0n,++n>ws&&(n=0n))),new r(Number(o),Number(n))}static fromNumber(t){if(t===0)return he;let e=t<0;e&&(t=-t);let n=t>>>0,o=(t-n)/4294967296>>>0;return e&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new r(n,o)}static from(t){return typeof t=="number"?r.fromNumber(t):typeof t=="bigint"?r.fromBigInt(t):typeof t=="string"?r.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new r(t.low>>>0,t.high>>>0):he}},he=new wt(0,0);he.toBigInt=function(){return 0n};he.zzEncode=he.zzDecode=function(){return this};he.length=function(){return 1};var ws=4294967296n;function Es(r){let t=0,e=0;for(let n=0;n<r.length;++n)e=r.charCodeAt(n),e<128?t+=1:e<2048?t+=2:(e&64512)===55296&&(r.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function Ss(r,t,e){if(e-t<1)return"";let o,s=[],i=0,a;for(;t<e;)a=r[t++],a<128?s[i++]=a:a>191&&a<224?s[i++]=(a&31)<<6|r[t++]&63:a>239&&a<365?(a=((a&7)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,s[i++]=55296+(a>>10),s[i++]=56320+(a&1023)):s[i++]=(a&15)<<12|(r[t++]&63)<<6|r[t++]&63,i>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,s)),i=0);return o!=null?(i>0&&o.push(String.fromCharCode.apply(String,s.slice(0,i))),o.join("")):String.fromCharCode.apply(String,s.slice(0,i))}function Tn(r,t,e){let n=e,o,s;for(let i=0;i<r.length;++i)o=r.charCodeAt(i),o<128?t[e++]=o:o<2048?(t[e++]=o>>6|192,t[e++]=o&63|128):(o&64512)===55296&&((s=r.charCodeAt(i+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++i,t[e++]=o>>18|240,t[e++]=o>>12&63|128,t[e++]=o>>6&63|128,t[e++]=o&63|128):(t[e++]=o>>12|224,t[e++]=o>>6&63|128,t[e++]=o&63|128);return e-n}function Lt(r,t){return RangeError(`index out of range: ${r.pos} + ${t??1} > ${r.len}`)}function mr(r,t){return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0}var Ln=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Lt(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw Lt(this,4);return mr(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Lt(this,4);return mr(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw Lt(this,4);let t=gs(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw Lt(this,4);let t=xs(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw Lt(this,t);return this.pos+=t,e===n?new Uint8Array(0):this.buf.subarray(e,n)}string(){let t=this.bytes();return Ss(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Lt(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Lt(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new wt(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Lt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Lt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Lt(this,8);let t=mr(this.buf,this.pos+=4),e=mr(this.buf,this.pos+=4);return new wt(t,e)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let t=vn(this.buf,this.pos);return this.pos+=xt(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function Un(r){return new Ln(r instanceof Uint8Array?r:r.subarray())}function Ht(r,t,e){let n=Un(r);return t.decode(n,void 0,e)}var Rn={};dt(Rn,{base10:()=>Dc});var Dc=Zt({prefix:"9",name:"base10",alphabet:"0123456789"});var Pn={};dt(Pn,{base16:()=>_c,base16upper:()=>Kc});var _c=J({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Kc=J({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Cn={};dt(Cn,{base2:()=>kc});var kc=J({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Nn={};dt(Nn,{base256emoji:()=>Vc});var As=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Oc=As.reduce((r,t,e)=>(r[e]=t,r),[]),Mc=As.reduce((r,t,e)=>{let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return r[n]=e,r},[]);function qc(r){return r.reduce((t,e)=>(t+=Oc[e],t),"")}function Hc(r){let t=[];for(let e of r){let n=e.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${e}`);let o=Mc[n];if(o==null)throw new Error(`Non-base256emoji character: ${e}`);t.push(o)}return new Uint8Array(t)}var Vc=ge({prefix:"\u{1F680}",name:"base256emoji",encode:qc,decode:Hc});var Dn={};dt(Dn,{base64:()=>zc,base64pad:()=>Fc,base64url:()=>Gc,base64urlpad:()=>Zc});var zc=J({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Fc=J({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Gc=J({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Zc=J({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var _n={};dt(_n,{base8:()=>$c});var $c=J({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Kn={};dt(Kn,{identity:()=>Yc});var Yc=ge({prefix:"\0",name:"identity",encode:r=>No(r),decode:r=>Co(r)});var Ul=new TextEncoder,Rl=new TextDecoder;var Mn={};dt(Mn,{sha256:()=>He,sha512:()=>Xc});function On({name:r,code:t,encode:e}){return new kn(r,t,e)}var kn=class{name;code;encode;constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?At(this.code,e):e.then(n=>At(this.code,n))}else throw Error("Unknown type, must be binary type")}};function Is(r){return async t=>new Uint8Array(await crypto.subtle.digest(r,t))}var He=On({name:"sha2-256",code:18,encode:Is("SHA-256")}),Xc=On({name:"sha2-512",code:19,encode:Is("SHA-512")});var Ve={...Kn,...Cn,..._n,...Rn,...Pn,...$r,...Yr,...Zr,...Dn,...Nn},Vl={...Mn,...Xr};function Ls(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}var Ts=Ls("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),qn=Ls("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);let t=bt(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),Jc={utf8:Ts,"utf-8":Ts,hex:Ve.base16,latin1:qn,ascii:qn,binary:qn,...Ve},yr=Jc;function j(r,t="utf8"){let e=yr[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return e.decoder.decode(`${e.prefix}${r}`)}function Hn(r){let t=r??8192,e=t>>>1,n,o=t;return function(i){if(i<1||i>e)return bt(i);o+i>t&&(n=bt(t),o=0);let a=n.subarray(o,o+=i);return(o&7)!==0&&(o=(o|7)+1),a}}var de=class{fn;len;next;val;constructor(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}};function Vn(){}var Fn=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},Qc=Hn();function tu(r){return globalThis.Buffer!=null?bt(r):Qc(r)}var Fe=class{len;head;tail;states;constructor(){this.len=0,this.head=new de(Vn,0,0),this.tail=this.head,this.states=null}_push(t,e,n){return this.tail=this.tail.next=new de(t,e,n),this.len+=e,this}uint32(t){return this.len+=(this.tail=this.tail.next=new Gn((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(gr,10,wt.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let e=wt.fromBigInt(t);return this._push(gr,e.length(),e)}uint64Number(t){return this._push(Sn,xt(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let e=wt.fromBigInt(t).zzEncode();return this._push(gr,e.length(),e)}sint64Number(t){let e=wt.fromNumber(t).zzEncode();return this._push(gr,e.length(),e)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(zn,1,t?1:0)}fixed32(t){return this._push(ze,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let e=wt.fromBigInt(t);return this._push(ze,4,e.lo)._push(ze,4,e.hi)}fixed64Number(t){let e=wt.fromNumber(t);return this._push(ze,4,e.lo)._push(ze,4,e.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(ys,4,t)}double(t){return this._push(bs,8,t)}bytes(t){let e=t.length>>>0;return e===0?this._push(zn,1,0):this.uint32(e)._push(ru,e,t)}string(t){let e=Es(t);return e!==0?this.uint32(e)._push(Tn,e,t):this._push(zn,1,0)}fork(){return this.states=new Fn(this),this.head=this.tail=new de(Vn,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new de(Vn,0,0),this.len=0),this}ldelim(){let t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=e,this.len+=n),this}finish(){let t=this.head.next,e=tu(this.len),n=0;for(;t!=null;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e}};function zn(r,t,e){t[e]=r&255}function eu(r,t,e){for(;r>127;)t[e++]=r&127|128,r>>>=7;t[e]=r}var Gn=class extends de{next;constructor(t,e){super(eu,t,e),this.next=void 0}};function gr(r,t,e){for(;r.hi!==0;)t[e++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)t[e++]=r.lo&127|128,r.lo=r.lo>>>7;t[e++]=r.lo}function ze(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}function ru(r,t,e){t.set(r,e)}globalThis.Buffer!=null&&(Fe.prototype.bytes=function(r){let t=r.length>>>0;return this.uint32(t),t>0&&this._push(nu,t,r),this},Fe.prototype.string=function(r){let t=globalThis.Buffer.byteLength(r);return this.uint32(t),t>0&&this._push(ou,t,r),this});function nu(r,t,e){t.set(r,e)}function ou(r,t,e){r.length<40?Tn(r,t,e):t.utf8Write!=null?t.utf8Write(r,e):t.set(j(r),e)}function Zn(){return new Fe}function Vt(r,t){let e=Zn();return t.encode(r,e,{lengthDelimited:!1}),e.finish()}var Te;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(Te||(Te={}));function br(r,t,e,n){return{name:r,type:t,encode:e,decode:n}}function $n(r){function t(o){if(r[o.toString()]==null)throw new Error("Invalid enum value");return r[o]}let e=function(s,i){let a=t(s);i.int32(a)},n=function(s){let i=s.int32();return t(i)};return br("enum",Te.VARINT,e,n)}function zt(r,t){return br("message",Te.LENGTH_DELIMITED,r,t)}var xr=class extends Error{code="ERR_MAX_LENGTH";name="MaxLengthError"};var et;(function(r){r.RSA="RSA",r.Ed25519="Ed25519",r.secp256k1="secp256k1"})(et||(et={}));var Yn;(function(r){r[r.RSA=0]="RSA",r[r.Ed25519=1]="Ed25519",r[r.secp256k1=2]="secp256k1"})(Yn||(Yn={}));(function(r){r.codec=()=>$n(Yn)})(et||(et={}));var Ct;(function(r){let t;r.codec=()=>(t==null&&(t=zt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.Type!=null&&(n.uint32(8),et.codec().encode(e.Type,n)),e.Data!=null&&(n.uint32(18),n.bytes(e.Data)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.Type=et.codec().decode(e);break}case 2:{s.Data=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>Vt(e,r.codec()),r.decode=(e,n)=>Ht(e,r.codec(),n)})(Ct||(Ct={}));var jn;(function(r){let t;r.codec=()=>(t==null&&(t=zt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.Type!=null&&(n.uint32(8),et.codec().encode(e.Type,n)),e.Data!=null&&(n.uint32(18),n.bytes(e.Data)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.Type=et.codec().decode(e);break}case 2:{s.Data=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>Vt(e,r.codec()),r.decode=(e,n)=>Ht(e,r.codec(),n)})(jn||(jn={}));var $e={};dt($e,{MAX_RSA_KEY_SIZE:()=>to,generateRSAKeyPair:()=>zs,jwkToJWKKeyPair:()=>Fs,jwkToPkcs1:()=>yu,jwkToPkix:()=>ro,jwkToRSAPrivateKey:()=>Vs,pkcs1ToJwk:()=>Ms,pkcs1ToRSAPrivateKey:()=>Hs,pkixToJwk:()=>qs,pkixToRSAPublicKey:()=>no});var su=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ee=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),re=new Uint32Array(64),Wn=class extends Ae{constructor(){super(64,32,8,!1),this.A=ee[0]|0,this.B=ee[1]|0,this.C=ee[2]|0,this.D=ee[3]|0,this.E=ee[4]|0,this.F=ee[5]|0,this.G=ee[6]|0,this.H=ee[7]|0}get(){let{A:t,B:e,C:n,D:o,E:s,F:i,G:a,H:c}=this;return[t,e,n,o,s,i,a,c]}set(t,e,n,o,s,i,a,c){this.A=t|0,this.B=e|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=a|0,this.H=c|0}process(t,e){for(let l=0;l<16;l++,e+=4)re[l]=t.getUint32(e,!1);for(let l=16;l<64;l++){let p=re[l-15],x=re[l-2],w=Bt(p,7)^Bt(p,18)^p>>>3,g=Bt(x,17)^Bt(x,19)^x>>>10;re[l]=g+re[l-7]+w+re[l-16]|0}let{A:n,B:o,C:s,D:i,E:a,F:c,G:f,H:u}=this;for(let l=0;l<64;l++){let p=Bt(a,6)^Bt(a,11)^Bt(a,25),x=u+p+Wo(a,c,f)+su[l]+re[l]|0,g=(Bt(n,2)^Bt(n,13)^Bt(n,22))+Xo(n,o,s)|0;u=f,f=c,c=a,a=i+x|0,i=s,s=o,o=n,n=x+g|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,o,s,i,a,c,f,u)}roundClean(){re.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Le=rr(()=>new Wn);function H(r,t="utf8"){let e=yr[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return e.encoder.encode(r).substring(1)}function Et(r,t){t==null&&(t=r.reduce((o,s)=>o+s.length,0));let e=bt(t),n=0;for(let o of r)e.set(o,n),n+=o.length;return e}var Ps=Symbol.for("@achingbrain/uint8arraylist");function Rs(r,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let e=0;for(let n of r){let o=e+n.byteLength;if(t<o)return{buf:n,index:t-e};e=o}throw new RangeError("index is out of bounds")}function wr(r){return!!r?.[Ps]}var St=class r{bufs;length;[Ps]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let e=0;for(let n of t)if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.push(n);else if(wr(n))e+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}prepend(...t){this.prependAll(t)}prependAll(t){let e=0;for(let n of t.reverse())if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.unshift(n);else if(wr(n))e+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}get(t){let e=Rs(this.bufs,t);return e.buf[e.index]}set(t,e){let n=Rs(this.bufs,t);n.buf[n.index]=e}write(t,e=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(e+n,t[n]);else if(wr(t))for(let n=0;n<t.length;n++)this.set(e+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,e){let{bufs:n,length:o}=this._subList(t,e);return Et(n,o)}subarray(t,e){let{bufs:n,length:o}=this._subList(t,e);return n.length===1?n[0]:Et(n,o)}sublist(t,e){let{bufs:n,length:o}=this._subList(t,e),s=new r;return s.length=o,s.bufs=[...n],s}_subList(t,e){if(t=t??0,e=e??this.length,t<0&&(t=this.length+t),e<0&&(e=this.length+e),t<0||e>this.length)throw new RangeError("index is out of bounds");if(t===e)return{bufs:[],length:0};if(t===0&&e===this.length)return{bufs:this.bufs,length:this.length};let n=[],o=0;for(let s=0;s<this.bufs.length;s++){let i=this.bufs[s],a=o,c=a+i.byteLength;if(o=c,t>=c)continue;let f=t>=a&&t<c,u=e>a&&e<=c;if(f&&u){if(t===a&&e===c){n.push(i);break}let l=t-a;n.push(i.subarray(l,l+(e-t)));break}if(f){if(t===0){n.push(i);continue}n.push(i.subarray(t-a));continue}if(u){if(e===c){n.push(i);break}n.push(i.subarray(0,e-a));break}n.push(i)}return{bufs:n,length:e-t}}indexOf(t,e=0){if(!wr(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(e=Number(e??0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let s=256,i=new Int32Array(s);for(let l=0;l<s;l++)i[l]=-1;for(let l=0;l<o;l++)i[n[l]]=l;let a=i,c=this.byteLength-n.byteLength,f=n.byteLength-1,u;for(let l=e;l<=c;l+=u){u=0;for(let p=f;p>=0;p--){let x=this.get(l+p);if(n[p]!==x){u=Math.max(1,p-a[x]);break}}if(u===0)return l}return-1}getInt8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt8(0)}setInt8(t,e){let n=bt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,e),this.write(n,t)}getInt16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,e)}setInt16(t,e,n){let o=at(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,e,n),this.write(o,t)}getInt32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,e)}setInt32(t,e,n){let o=at(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,e,n),this.write(o,t)}getBigInt64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,e)}setBigInt64(t,e,n){let o=at(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,e,n),this.write(o,t)}getUint8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0)}setUint8(t,e){let n=bt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,e),this.write(n,t)}getUint16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,e)}setUint16(t,e,n){let o=at(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,e,n),this.write(o,t)}getUint32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,e)}setUint32(t,e,n){let o=at(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,e,n),this.write(o,t)}getBigUint64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,e)}setBigUint64(t,e,n){let o=at(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,e,n),this.write(o,t)}getFloat32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,e)}setFloat32(t,e,n){let o=at(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,e,n),this.write(o,t)}getFloat64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,e)}setFloat64(t,e,n){let o=at(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,e,n),this.write(o,t)}equals(t){if(t==null||!(t instanceof r)||t.bufs.length!==this.bufs.length)return!1;for(let e=0;e<this.bufs.length;e++)if(!ut(this.bufs[e],t.bufs[e]))return!1;return!0}static fromUint8Arrays(t,e){let n=new r;return n.bufs=t,e==null&&(e=t.reduce((o,s)=>o+s.byteLength,0)),n.length=e,n}};var iu=parseInt("11111",2),Jn=parseInt("10000000",2),au=parseInt("01111111",2),Cs={2:cu,3:lu,5:fu,6:uu,16:Xn,22:Xn,48:Xn};function Ge(r,t={offset:0}){let e=r[t.offset]&iu;if(t.offset++,Cs[e]!=null)return Cs[e](r,t);throw new Error("No decoder for tag "+e)}function Er(r,t){let e=0;if((r[t.offset]&Jn)===Jn){let n=r[t.offset]&au,o="0x";t.offset++;for(let s=0;s<n;s++,t.offset++)o+=r[t.offset].toString(16).padStart(2,"0");e=parseInt(o,16)}else e=r[t.offset],t.offset++;return e}function Xn(r,t){Er(r,t);let e=[];for(;!(t.offset>=r.byteLength);){let n=Ge(r,t);if(n===null)break;e.push(n)}return e}function cu(r,t){let e=Er(r,t),n=t.offset,o=t.offset+e,s=[];for(let i=n;i<o;i++)i===n&&r[i]===0||s.push(r[i]);return t.offset+=e,Uint8Array.from(s)}function uu(r,t){let e=Er(r,t);return t.offset+=e,["oid-unimplemented"]}function fu(r,t){return t.offset++,null}function lu(r,t){let e=Er(r,t),n=r[t.offset];t.offset++;let o=r.subarray(t.offset,t.offset+e);if(t.offset+=e,n!==0)throw new Error("Unused bits in bit string is unimplemented");return Ge(o,{offset:0})}function hu(r){let t=r.toString(16);t.length%2===1&&(t="0"+t);let e=new St;for(let n=0;n<t.length;n+=2)e.append(Uint8Array.from([parseInt(`${t[n]}${t[n+1]}`,16)]));return e}function Qn(r){if(r.byteLength<128)return Uint8Array.from([r.byteLength]);let t=hu(r.byteLength);return new St(Uint8Array.from([t.byteLength|Jn]),t)}function vt(r){let t=new St,e=parseInt("10000000",2);return(r.subarray()[0]&e)===e&&t.append(Uint8Array.from([0])),t.append(r),new St(Uint8Array.from([2]),Qn(t),t)}function Ns(r){let t=Uint8Array.from([0]),e=new St(t,r);return new St(Uint8Array.from([3]),Qn(e),e)}function Sr(r){let t=new St;for(let e of r)t.append(e);return new St(Uint8Array.from([48]),Qn(t),t)}var Ze=class extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}},vr=class extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}};var Ds={get(r=globalThis){let t=r.crypto;if(t?.subtle==null)throw new vr("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};var ne=Ds;async function _s(r){let t=await ne.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),e=await du(t);return{privateKey:e[0],publicKey:e[1]}}async function Ks(r,t){let e=await ne.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await ne.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},e,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(n,0,n.byteLength)}async function ks(r,t,e){let n=await ne.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return ne.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,e instanceof Uint8Array?e:e.subarray())}async function du(r){if(r.privateKey==null||r.publicKey==null)throw new pt("Private and public key are required");return Promise.all([ne.get().subtle.exportKey("jwk",r.privateKey),ne.get().subtle.exportKey("jwk",r.publicKey)])}function Os(r){if(r.kty!=="RSA")throw new pt("invalid key type");if(r.n==null)throw new pt("invalid key modulus");return j(r.n,"base64url").length*8}var Ue=class{type="RSA";_key;_raw;_multihash;constructor(t,e){this._key=t,this._multihash=e}get raw(){return this._raw==null&&(this._raw=$e.jwkToPkix(this._key)),this._raw}toMultihash(){return this._multihash}toCID(){return it.createV1(114,this._multihash)}toString(){return W.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ut(this.raw,t.raw)}verify(t,e){return ks(this._key,e,t)}},Ye=class{type="RSA";_key;_raw;publicKey;constructor(t,e){this._key=t,this.publicKey=e}get raw(){return this._raw==null&&(this._raw=$e.jwkToPkcs1(this._key)),this._raw}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ut(this.raw,t.raw)}sign(t){return Ks(this._key,t)}};var to=8192,eo=18,pu=1062,mu=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function Ms(r){let t=Ge(r);return{n:H(t[1],"base64url"),e:H(t[2],"base64url"),d:H(t[3],"base64url"),p:H(t[4],"base64url"),q:H(t[5],"base64url"),dp:H(t[6],"base64url"),dq:H(t[7],"base64url"),qi:H(t[8],"base64url"),kty:"RSA"}}function yu(r){if(r.n==null||r.e==null||r.d==null||r.p==null||r.q==null||r.dp==null||r.dq==null||r.qi==null)throw new pt("JWK was missing components");return Sr([vt(Uint8Array.from([0])),vt(j(r.n,"base64url")),vt(j(r.e,"base64url")),vt(j(r.d,"base64url")),vt(j(r.p,"base64url")),vt(j(r.q,"base64url")),vt(j(r.dp,"base64url")),vt(j(r.dq,"base64url")),vt(j(r.qi,"base64url"))]).subarray()}function qs(r){let t=Ge(r,{offset:0});return{kty:"RSA",n:H(t[1][0],"base64url"),e:H(t[1][1],"base64url")}}function ro(r){if(r.n==null||r.e==null)throw new pt("JWK was missing components");return Sr([mu,Ns(Sr([vt(j(r.n,"base64url")),vt(j(r.e,"base64url"))]))]).subarray()}function Hs(r){let t=Ms(r);return Vs(t)}function no(r,t){if(r.byteLength>=pu)throw new me("Key size is too large");let e=qs(r);if(t==null){let n=Le(Ct.encode({Type:et.RSA,Data:r}));t=At(eo,n)}return new Ue(e,t)}function Vs(r){if(Os(r)>to)throw new pt("Key size is too large");let t=Fs(r),e=Le(Ct.encode({Type:et.RSA,Data:ro(t.publicKey)})),n=At(eo,e);return new Ye(t.privateKey,new Ue(t.publicKey,n))}async function zs(r){if(r>to)throw new pt("Key size is too large");let t=await _s(r),e=Le(Ct.encode({Type:et.RSA,Data:ro(t.publicKey)})),n=At(eo,e);return new Ye(t.privateKey,new Ue(t.publicKey,n))}function Fs(r){if(r==null)throw new pt("Missing key parameter");return{privateKey:r,publicKey:{kty:r.kty,n:r.n,e:r.e}}}var Ar=class extends ve{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,$o(t);let n=ke(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?t.create().update(n).digest():n);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return Se(this),this.iHash.update(t),this}digestInto(t){Se(this),Ee(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},oo=(r,t,e)=>new Ar(r,t).update(e).digest();oo.create=(r,t)=>new Ar(r,t);function Gs(r){r.lowS!==void 0&&It("lowS",r.lowS),r.prehash!==void 0&&It("prehash",r.prehash)}function gu(r){let t=qe(r);Rt(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:e,Fp:n,a:o}=t;if(e){if(!n.eql(o,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:bu,hexToBytes:xu}=ar,so=class extends Error{constructor(t=""){super(t)}},Ft={Err:so,_tlv:{encode:(r,t)=>{let{Err:e}=Ft;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length&1)throw new e("tlv.encode: unpadded data");let n=t.length/2,o=ie(n);if(o.length/2&128)throw new e("tlv.encode: long form length too big");let s=n>127?ie(o.length/2|128):"";return ie(r)+s+o+t},decode(r,t){let{Err:e}=Ft,n=0;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[n++]!==r)throw new e("tlv.decode: wrong tlv");let o=t[n++],s=!!(o&128),i=0;if(!s)i=o;else{let c=o&127;if(!c)throw new e("tlv.decode(long): indefinite length not supported");if(c>4)throw new e("tlv.decode(long): byte length is too big");let f=t.subarray(n,n+c);if(f.length!==c)throw new e("tlv.decode: length bytes not complete");if(f[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(let u of f)i=i<<8|u;if(n+=c,i<128)throw new e("tlv.decode(long): not minimal encoding")}let a=t.subarray(n,n+i);if(a.length!==i)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+i)}}},_int:{encode(r){let{Err:t}=Ft;if(r<Gt)throw new t("integer: negative integers are not allowed");let e=ie(r);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode(r){let{Err:t}=Ft;if(r[0]&128)throw new t("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return bu(r)}},toSig(r){let{Err:t,_int:e,_tlv:n}=Ft,o=typeof r=="string"?xu(r):r;Be(o);let{v:s,l:i}=n.decode(48,o);if(i.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=n.decode(2,s),{v:f,l:u}=n.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(a),s:e.decode(f)}},hexFromSig(r){let{_tlv:t,_int:e}=Ft,n=t.encode(2,e.encode(r.r)),o=t.encode(2,e.encode(r.s)),s=n+o;return t.encode(48,s)}},Gt=BigInt(0),ot=BigInt(1),fd=BigInt(2),Zs=BigInt(3),ld=BigInt(4);function wu(r){let t=gu(r),{Fp:e}=t,n=Qt(t.n,t.nBitLength),o=t.toBytes||((g,h,E)=>{let v=h.toAffine();return qt(Uint8Array.from([4]),e.toBytes(v.x),e.toBytes(v.y))}),s=t.fromBytes||(g=>{let h=g.subarray(1),E=e.fromBytes(h.subarray(0,e.BYTES)),v=e.fromBytes(h.subarray(e.BYTES,2*e.BYTES));return{x:E,y:v}});function i(g){let{a:h,b:E}=t,v=e.sqr(g),m=e.mul(v,g);return e.add(e.add(m,e.mul(g,h)),E)}if(!e.eql(e.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function a(g){return Oe(g,ot,t.n)}function c(g){let{allowedPrivateKeyLengths:h,nByteLength:E,wrapPrivateKey:v,n:m}=t;if(h&&typeof g!="bigint"){if(Wt(g)&&(g=Ot(g)),typeof g!="string"||!h.includes(g.length))throw new Error("invalid private key");g=g.padStart(E*2,"0")}let B;try{B=typeof g=="bigint"?g:Mt(X("private key",g,E))}catch{throw new Error("invalid private key, expected hex or "+E+" bytes, got "+typeof g)}return v&&(B=z(B,m)),yt("private key",B,ot,m),B}function f(g){if(!(g instanceof p))throw new Error("ProjectivePoint expected")}let u=ue((g,h)=>{let{px:E,py:v,pz:m}=g;if(e.eql(m,e.ONE))return{x:E,y:v};let B=g.is0();h==null&&(h=B?e.ONE:e.inv(m));let P=e.mul(E,h),R=e.mul(v,h),I=e.mul(m,h);if(B)return{x:e.ZERO,y:e.ZERO};if(!e.eql(I,e.ONE))throw new Error("invZ was invalid");return{x:P,y:R}}),l=ue(g=>{if(g.is0()){if(t.allowInfinityPoint&&!e.is0(g.py))return;throw new Error("bad point: ZERO")}let{x:h,y:E}=g.toAffine();if(!e.isValid(h)||!e.isValid(E))throw new Error("bad point: x or y not FE");let v=e.sqr(E),m=i(h);if(!e.eql(v,m))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class p{constructor(h,E,v){if(this.px=h,this.py=E,this.pz=v,h==null||!e.isValid(h))throw new Error("x required");if(E==null||!e.isValid(E))throw new Error("y required");if(v==null||!e.isValid(v))throw new Error("z required");Object.freeze(this)}static fromAffine(h){let{x:E,y:v}=h||{};if(!h||!e.isValid(E)||!e.isValid(v))throw new Error("invalid affine point");if(h instanceof p)throw new Error("projective point not allowed");let m=B=>e.eql(B,e.ZERO);return m(E)&&m(v)?p.ZERO:new p(E,v,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(h){let E=e.invertBatch(h.map(v=>v.pz));return h.map((v,m)=>v.toAffine(E[m])).map(p.fromAffine)}static fromHex(h){let E=p.fromAffine(s(X("pointHex",h)));return E.assertValidity(),E}static fromPrivateKey(h){return p.BASE.multiply(c(h))}static msm(h,E){return lr(p,n,h,E)}_setWindowSize(h){w.setWindowSize(this,h)}assertValidity(){l(this)}hasEvenY(){let{y:h}=this.toAffine();if(e.isOdd)return!e.isOdd(h);throw new Error("Field doesn't support isOdd")}equals(h){f(h);let{px:E,py:v,pz:m}=this,{px:B,py:P,pz:R}=h,I=e.eql(e.mul(E,R),e.mul(B,m)),U=e.eql(e.mul(v,R),e.mul(P,m));return I&&U}negate(){return new p(this.px,e.neg(this.py),this.pz)}double(){let{a:h,b:E}=t,v=e.mul(E,Zs),{px:m,py:B,pz:P}=this,R=e.ZERO,I=e.ZERO,U=e.ZERO,T=e.mul(m,m),Z=e.mul(B,B),M=e.mul(P,P),k=e.mul(m,B);return k=e.add(k,k),U=e.mul(m,P),U=e.add(U,U),R=e.mul(h,U),I=e.mul(v,M),I=e.add(R,I),R=e.sub(Z,I),I=e.add(Z,I),I=e.mul(R,I),R=e.mul(k,R),U=e.mul(v,U),M=e.mul(h,M),k=e.sub(T,M),k=e.mul(h,k),k=e.add(k,U),U=e.add(T,T),T=e.add(U,T),T=e.add(T,M),T=e.mul(T,k),I=e.add(I,T),M=e.mul(B,P),M=e.add(M,M),T=e.mul(M,k),R=e.sub(R,T),U=e.mul(M,Z),U=e.add(U,U),U=e.add(U,U),new p(R,I,U)}add(h){f(h);let{px:E,py:v,pz:m}=this,{px:B,py:P,pz:R}=h,I=e.ZERO,U=e.ZERO,T=e.ZERO,Z=t.a,M=e.mul(t.b,Zs),k=e.mul(E,B),Q=e.mul(v,P),S=e.mul(m,R),L=e.add(E,v),y=e.add(B,P);L=e.mul(L,y),y=e.add(k,Q),L=e.sub(L,y),y=e.add(E,m);let d=e.add(B,R);return y=e.mul(y,d),d=e.add(k,S),y=e.sub(y,d),d=e.add(v,m),I=e.add(P,R),d=e.mul(d,I),I=e.add(Q,S),d=e.sub(d,I),T=e.mul(Z,y),I=e.mul(M,S),T=e.add(I,T),I=e.sub(Q,T),T=e.add(Q,T),U=e.mul(I,T),Q=e.add(k,k),Q=e.add(Q,k),S=e.mul(Z,S),y=e.mul(M,y),Q=e.add(Q,S),S=e.sub(k,S),S=e.mul(Z,S),y=e.add(y,S),k=e.mul(Q,y),U=e.add(U,k),k=e.mul(d,y),I=e.mul(L,I),I=e.sub(I,k),k=e.mul(L,Q),T=e.mul(d,T),T=e.add(T,k),new p(I,U,T)}subtract(h){return this.add(h.negate())}is0(){return this.equals(p.ZERO)}wNAF(h){return w.wNAFCached(this,h,p.normalizeZ)}multiplyUnsafe(h){let{endo:E,n:v}=t;yt("scalar",h,Gt,v);let m=p.ZERO;if(h===Gt)return m;if(this.is0()||h===ot)return this;if(!E||w.hasPrecomputes(this))return w.wNAFCachedUnsafe(this,h,p.normalizeZ);let{k1neg:B,k1:P,k2neg:R,k2:I}=E.splitScalar(h),U=m,T=m,Z=this;for(;P>Gt||I>Gt;)P&ot&&(U=U.add(Z)),I&ot&&(T=T.add(Z)),Z=Z.double(),P>>=ot,I>>=ot;return B&&(U=U.negate()),R&&(T=T.negate()),T=new p(e.mul(T.px,E.beta),T.py,T.pz),U.add(T)}multiply(h){let{endo:E,n:v}=t;yt("scalar",h,ot,v);let m,B;if(E){let{k1neg:P,k1:R,k2neg:I,k2:U}=E.splitScalar(h),{p:T,f:Z}=this.wNAF(R),{p:M,f:k}=this.wNAF(U);T=w.constTimeNegate(P,T),M=w.constTimeNegate(I,M),M=new p(e.mul(M.px,E.beta),M.py,M.pz),m=T.add(M),B=Z.add(k)}else{let{p:P,f:R}=this.wNAF(h);m=P,B=R}return p.normalizeZ([m,B])[0]}multiplyAndAddUnsafe(h,E,v){let m=p.BASE,B=(R,I)=>I===Gt||I===ot||!R.equals(m)?R.multiplyUnsafe(I):R.multiply(I),P=B(this,E).add(B(h,v));return P.is0()?void 0:P}toAffine(h){return u(this,h)}isTorsionFree(){let{h,isTorsionFree:E}=t;if(h===ot)return!0;if(E)return E(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h,clearCofactor:E}=t;return h===ot?this:E?E(p,this):this.multiplyUnsafe(t.h)}toRawBytes(h=!0){return It("isCompressed",h),this.assertValidity(),o(p,this,h)}toHex(h=!0){return It("isCompressed",h),Ot(this.toRawBytes(h))}}p.BASE=new p(t.Gx,t.Gy,e.ONE),p.ZERO=new p(e.ZERO,e.ONE,e.ZERO);let x=t.nBitLength,w=fr(p,t.endo?Math.ceil(x/2):x);return{CURVE:t,ProjectivePoint:p,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:a}}function Eu(r){let t=qe(r);return Rt(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function $s(r){let t=Eu(r),{Fp:e,n}=t,o=e.BYTES+1,s=2*e.BYTES+1;function i(S){return z(S,n)}function a(S){return cr(S,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:f,weierstrassEquation:u,isWithinCurveOrder:l}=wu({...t,toBytes(S,L,y){let d=L.toAffine(),b=e.toBytes(d.x),A=qt;return It("isCompressed",y),y?A(Uint8Array.from([L.hasEvenY()?2:3]),b):A(Uint8Array.from([4]),b,e.toBytes(d.y))},fromBytes(S){let L=S.length,y=S[0],d=S.subarray(1);if(L===o&&(y===2||y===3)){let b=Mt(d);if(!Oe(b,ot,e.ORDER))throw new Error("Point is not on curve");let A=u(b),C;try{C=e.sqrt(A)}catch(O){let D=O instanceof Error?": "+O.message:"";throw new Error("Point is not on curve"+D)}let N=(C&ot)===ot;return(y&1)===1!==N&&(C=e.neg(C)),{x:b,y:C}}else if(L===s&&y===4){let b=e.fromBytes(d.subarray(0,e.BYTES)),A=e.fromBytes(d.subarray(e.BYTES,2*e.BYTES));return{x:b,y:A}}else{let b=o,A=s;throw new Error("invalid Point, expected length of "+b+", or uncompressed "+A+", got "+L)}}}),p=S=>Ot(Jt(S,t.nByteLength));function x(S){let L=n>>ot;return S>L}function w(S){return x(S)?i(-S):S}let g=(S,L,y)=>Mt(S.slice(L,y));class h{constructor(L,y,d){this.r=L,this.s=y,this.recovery=d,this.assertValidity()}static fromCompact(L){let y=t.nByteLength;return L=X("compactSignature",L,y*2),new h(g(L,0,y),g(L,y,2*y))}static fromDER(L){let{r:y,s:d}=Ft.toSig(X("DER",L));return new h(y,d)}assertValidity(){yt("r",this.r,ot,n),yt("s",this.s,ot,n)}addRecoveryBit(L){return new h(this.r,this.s,L)}recoverPublicKey(L){let{r:y,s:d,recovery:b}=this,A=R(X("msgHash",L));if(b==null||![0,1,2,3].includes(b))throw new Error("recovery id invalid");let C=b===2||b===3?y+t.n:y;if(C>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");let N=(b&1)===0?"02":"03",K=c.fromHex(N+p(C)),O=a(C),D=i(-A*O),V=i(d*O),G=c.BASE.multiplyAndAddUnsafe(K,D,V);if(!G)throw new Error("point at infinify");return G.assertValidity(),G}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return ae(this.toDERHex())}toDERHex(){return Ft.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ae(this.toCompactHex())}toCompactHex(){return p(this.r)+p(this.s)}}let E={isValidPrivateKey(S){try{return f(S),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{let S=fn(t.n);return is(t.randomBytes(S),t.n)},precompute(S=8,L=c.BASE){return L._setWindowSize(S),L.multiply(BigInt(3)),L}};function v(S,L=!0){return c.fromPrivateKey(S).toRawBytes(L)}function m(S){let L=Wt(S),y=typeof S=="string",d=(L||y)&&S.length;return L?d===o||d===s:y?d===2*o||d===2*s:S instanceof c}function B(S,L,y=!0){if(m(S))throw new Error("first arg must be private key");if(!m(L))throw new Error("second arg must be public key");return c.fromHex(L).multiply(f(S)).toRawBytes(y)}let P=t.bits2int||function(S){if(S.length>8192)throw new Error("input is too large");let L=Mt(S),y=S.length*8-t.nBitLength;return y>0?L>>BigInt(y):L},R=t.bits2int_modN||function(S){return i(P(S))},I=Me(t.nBitLength);function U(S){return yt("num < 2^"+t.nBitLength,S,Gt,I),Jt(S,t.nByteLength)}function T(S,L,y=Z){if(["recovered","canonical"].some(nt=>nt in y))throw new Error("sign() legacy options not supported");let{hash:d,randomBytes:b}=t,{lowS:A,prehash:C,extraEntropy:N}=y;A==null&&(A=!0),S=X("msgHash",S),Gs(y),C&&(S=X("prehashed msgHash",d(S)));let K=R(S),O=f(L),D=[U(O),U(K)];if(N!=null&&N!==!1){let nt=N===!0?b(e.BYTES):N;D.push(X("extraEntropy",nt))}let V=qt(...D),G=K;function rt(nt){let st=P(nt);if(!l(st))return;let ct=a(st),mt=c.BASE.multiply(st).toAffine(),ht=i(mt.x);if(ht===Gt)return;let Ut=i(ct*i(G+ht*O));if(Ut===Gt)return;let Nt=(mt.x===ht?0:2)|Number(mt.y&ot),Ce=Ut;return A&&x(Ut)&&(Ce=w(Ut),Nt^=1),new h(ht,Ce,Nt)}return{seed:V,k2sig:rt}}let Z={lowS:t.lowS,prehash:!1},M={lowS:t.lowS,prehash:!1};function k(S,L,y=Z){let{seed:d,k2sig:b}=T(S,L,y),A=t;return sn(A.hash.outputLen,A.nByteLength,A.hmac)(d,b)}c.BASE._setWindowSize(8);function Q(S,L,y,d=M){let b=S;L=X("msgHash",L),y=X("publicKey",y);let{lowS:A,prehash:C,format:N}=d;if(Gs(d),"strict"in d)throw new Error("options.strict was renamed to lowS");if(N!==void 0&&N!=="compact"&&N!=="der")throw new Error("format must be compact or der");let K=typeof b=="string"||Wt(b),O=!K&&!N&&typeof b=="object"&&b!==null&&typeof b.r=="bigint"&&typeof b.s=="bigint";if(!K&&!O)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let D,V;try{if(O&&(D=new h(b.r,b.s)),K){try{N!=="compact"&&(D=h.fromDER(b))}catch(Nt){if(!(Nt instanceof Ft.Err))throw Nt}!D&&N!=="der"&&(D=h.fromCompact(b))}V=c.fromHex(y)}catch{return!1}if(!D||A&&D.hasHighS())return!1;C&&(L=t.hash(L));let{r:G,s:rt}=D,nt=R(L),st=a(rt),ct=i(nt*st),mt=i(G*st),ht=c.BASE.multiplyAndAddUnsafe(V,ct,mt)?.toAffine();return ht?i(ht.x)===G:!1}return{CURVE:t,getPublicKey:v,getSharedSecret:B,sign:k,verify:Q,ProjectivePoint:c,Signature:h,utils:E}}function Su(r){return{hash:r,hmac:(t,...e)=>oo(r,t,Jr(...e)),randomBytes:nr}}function Ys(r,t){let e=n=>$s({...r,...Su(n)});return{...e(t),create:e}}var Xs=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),js=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),vu=BigInt(1),io=BigInt(2),Ws=(r,t)=>(r+t/io)/t;function Au(r){let t=Xs,e=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),a=BigInt(44),c=BigInt(88),f=r*r*r%t,u=f*f*r%t,l=Y(u,e,t)*u%t,p=Y(l,e,t)*u%t,x=Y(p,io,t)*f%t,w=Y(x,o,t)*x%t,g=Y(w,s,t)*w%t,h=Y(g,a,t)*g%t,E=Y(h,c,t)*h%t,v=Y(E,a,t)*g%t,m=Y(v,e,t)*u%t,B=Y(m,i,t)*w%t,P=Y(B,n,t)*f%t,R=Y(P,io,t);if(!ao.eql(ao.sqr(R),r))throw new Error("Cannot find square root");return R}var ao=Qt(Xs,void 0,void 0,{sqrt:Au}),pe=Ys({a:BigInt(0),b:BigInt(7),Fp:ao,n:js,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{let t=js,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-vu*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,i=BigInt("0x100000000000000000000000000000000"),a=Ws(s*r,t),c=Ws(-n*r,t),f=z(r-a*e-c*o,t),u=z(-a*n-c*s,t),l=f>i,p=u>i;if(l&&(f=t-f),p&&(u=t-u),f>i||u>i)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:l,k1:f,k2neg:p,k2:u}}}},Le),wd=BigInt(0);var Ed=pe.ProjectivePoint;function Js(r){return r==null?!1:typeof r.then=="function"&&typeof r.catch=="function"&&typeof r.finally=="function"}function Qs(r,t,e){let n=He.digest(e instanceof Uint8Array?e:e.subarray());if(Js(n))return n.then(({digest:o})=>pe.verify(t,o,r)).catch(o=>{throw new Ze(String(o))});try{return pe.verify(t,n.digest,r)}catch(o){throw new Ze(String(o))}}var Br=class{type="secp256k1";raw;_key;constructor(t){this._key=ei(t),this.raw=ti(this._key)}toMultihash(){return Kt.digest(Ie(this))}toCID(){return it.createV1(114,this.toMultihash())}toString(){return W.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ut(this.raw,t.raw)}verify(t,e){return Qs(this._key,e,t)}};function co(r){return new Br(r)}function ti(r){return pe.ProjectivePoint.fromHex(r).toRawBytes(!0)}function ei(r){try{return pe.ProjectivePoint.fromHex(r),r}catch(t){throw new me(String(t))}}function ri(r,t){let{Type:e,Data:n}=Ct.decode(r),o=n??new Uint8Array;switch(e){case et.RSA:return no(o,t);case et.Ed25519:return gn(o);case et.secp256k1:return co(o);default:throw new ye}}function ni(r){let{Type:t,Data:e}=Ct.decode(r.digest),n=e??new Uint8Array;switch(t){case et.Ed25519:return gn(n);case et.secp256k1:return co(n);default:throw new ye}}function Ie(r){return Ct.encode({Type:et[r.type],Data:r.raw})}var je;(function(r){let t;r.codec=()=>(t==null&&(t=zt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.publicKey!=null&&e.publicKey.byteLength>0&&(n.uint32(10),n.bytes(e.publicKey)),e.payloadType!=null&&e.payloadType.byteLength>0&&(n.uint32(18),n.bytes(e.payloadType)),e.payload!=null&&e.payload.byteLength>0&&(n.uint32(26),n.bytes(e.payload)),e.signature!=null&&e.signature.byteLength>0&&(n.uint32(42),n.bytes(e.signature)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={publicKey:at(0),payloadType:at(0),payload:at(0),signature:at(0)},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.publicKey=e.bytes();break}case 2:{s.payloadType=e.bytes();break}case 3:{s.payload=e.bytes();break}case 5:{s.signature=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>Vt(e,r.codec()),r.decode=(e,n)=>Ht(e,r.codec(),n)})(je||(je={}));var Ir=class extends Error{constructor(t="Invalid signature"){super(t),this.name="InvalidSignatureError"}};var Tr=class r{static createFromProtobuf=async t=>{let e=je.decode(t),n=ri(e.publicKey);return new r({publicKey:n,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};static seal=async(t,e)=>{if(e==null)throw new Error("Missing private key");let n=t.domain,o=t.codec,s=t.marshal(),i=oi(n,o,s),a=await e.sign(i.subarray());return new r({publicKey:e.publicKey,payloadType:o,payload:s,signature:a})};static openAndCertify=async(t,e)=>{let n=await r.createFromProtobuf(t);if(!await n.validate(e))throw new Ir("Envelope signature is not valid for the given domain");return n};publicKey;payloadType;payload;signature;marshaled;constructor(t){let{publicKey:e,payloadType:n,payload:o,signature:s}=t;this.publicKey=e,this.payloadType=n,this.payload=o,this.signature=s}marshal(){return this.marshaled==null&&(this.marshaled=je.encode({publicKey:Ie(this.publicKey),payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(t){return ut(this.marshal(),t.marshal())}async validate(t){let e=oi(t,this.payloadType,this.payload);return this.publicKey.verify(e.subarray(),this.signature)}},oi=(r,t,e)=>{let n=j(r),o=Pt(n.byteLength),s=Pt(t.length),i=Pt(e.length);return new St(o,n,s,t,i,e)};var si=Symbol.for("nodejs.util.inspect.custom"),Bu=114,We=class{type;multihash;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Hr]=!0;toString(){return this.string==null&&(this.string=W.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return it.createV1(Bu,this.multihash)}toJSON(){return this.toString()}equals(t){if(t==null)return!1;if(t instanceof Uint8Array)return ut(this.multihash.bytes,t);if(typeof t=="string")return this.toString()===t;if(t?.toMultihash()?.bytes!=null)return ut(this.multihash.bytes,t.toMultihash().bytes);throw new Error("not valid Id")}[si](){return`PeerId(${this.toString()})`}},Lr=class extends We{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},Ur=class extends We{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.publicKey}},Rr=class extends We{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.publicKey}},Iu=2336,Pr=class{type="url";multihash;publicKey;url;constructor(t){this.url=t.toString(),this.multihash=Kt.digest(j(this.url))}[si](){return`PeerId(${this.url})`}[Hr]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return it.createV1(Iu,this.toMultihash())}toJSON(){return this.toString()}equals(t){return t==null?!1:(t instanceof Uint8Array&&(t=H(t)),t.toString()===this.toString())}};function ii(r){if(Lu(r))return new Lr({multihash:r});if(Tu(r))try{let t=ni(r);if(t.type==="Ed25519")return new Ur({multihash:r,publicKey:t});if(t.type==="secp256k1")return new Rr({multihash:r,publicKey:t})}catch{let e=H(r.digest);return new Pr(new URL(e))}throw new Qe("Supplied PeerID Multihash is invalid")}function Tu(r){return r.code===Kt.code}function Lu(r){return r.code===He.code}function ai(r,t){let e=(n,o)=>n.toString().localeCompare(o.toString());return r.length!==t.length?!1:(t.sort(e),r.sort(e).every((n,o)=>t[o].equals(n)))}var Cr=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let e=this.index,n=t();return n===void 0&&(this.index=e),n}parseWith(t){let e=t();if(this.index===this.input.length)return e}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let e=this.readChar();if(e===t)return e})}readSeparator(t,e,n){return this.readAtomically(()=>{if(!(e>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,e,n,o){return this.readAtomically(()=>{let s=0,i=0,a=this.peekChar();if(a===void 0)return;let c=a==="0",f=2**(8*o)-1;for(;;){let u=this.readAtomically(()=>{let l=this.readChar();if(l===void 0)return;let p=Number.parseInt(l,t);if(!Number.isNaN(p))return p});if(u===void 0)break;if(s*=t,s+=u,s>f||(i+=1,e!==void 0&&i>e))return}if(i!==0)return!n&&c&&i>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let e=0;e<t.length;e++){let n=this.readSeparator(".",e,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[e]=n}return t})}readIPv6Addr(){let t=e=>{for(let n=0;n<e.length/2;n++){let o=n*2;if(n<e.length-3){let i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return e[o]=i[0],e[o+1]=i[1],e[o+2]=i[2],e[o+3]=i[3],[o+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[o,!1];e[o]=s>>8,e[o+1]=s&255}return[e.length,!1]};return this.readAtomically(()=>{let e=new Uint8Array(16),[n,o]=t(e);if(n===16)return e;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),i=16-(n+2),[a]=t(s.subarray(0,i));return e.set(s.subarray(0,a),16-a),e})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var ci=45,Uu=15,Re=new Cr;function uo(r){if(!(r.length>Uu))return Re.new(r).parseWith(()=>Re.readIPv4Addr())}function fo(r){if(r.includes("%")&&(r=r.split("%")[0]),!(r.length>ci))return Re.new(r).parseWith(()=>Re.readIPv6Addr())}function Nr(r,t=!1){if(r.includes("%")&&(r=r.split("%")[0]),r.length>ci)return;let e=Re.new(r).parseWith(()=>Re.readIPAddr());if(e)return t&&e.length===4?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,e[0],e[1],e[2],e[3]]):e}var F0=parseInt("0xFFFF",16),G0=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function li(r){return!!uo(r)}function hi(r){return!!fo(r)}function Dr(r){return!!Nr(r)}var di=li,Du=hi,lo=function(r){let t=0;if(r=r.toString().trim(),di(r)){let e=new Uint8Array(t+4);return r.split(/\./g).forEach(n=>{e[t++]=parseInt(n,10)&255}),e}if(Du(r)){let e=r.split(":",8),n;for(n=0;n<e.length;n++){let s=di(e[n]),i;s&&(i=lo(e[n]),e[n]=H(i.slice(0,2),"base16")),i!=null&&++n<8&&e.splice(n,0,H(i.slice(2,4),"base16"))}if(e[0]==="")for(;e.length<8;)e.unshift("0");else if(e[e.length-1]==="")for(;e.length<8;)e.push("0");else if(e.length<8){for(n=0;n<e.length&&e[n]!=="";n++);let s=[n,1];for(n=9-e.length;n>0;n--)s.push("0");e.splice.apply(e,s)}let o=new Uint8Array(t+16);for(n=0;n<e.length;n++){let s=parseInt(e[n],16);o[t++]=s>>8&255,o[t++]=s&255}return o}throw new Error("invalid ip address")},pi=function(r,t=0,e){t=~~t,e=e??r.length-t;let n=new DataView(r.buffer);if(e===4){let o=[];for(let s=0;s<e;s++)o.push(r[t+s]);return o.join(".")}if(e===16){let o=[];for(let s=0;s<e;s+=2)o.push(n.getUint16(t+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Pe={},ho={},Ku=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[481,-1,"http-path"],[777,-1,"memory"]];Ku.forEach(r=>{let t=ku(...r);ho[t.code]=t,Pe[t.name]=t});function ku(r,t,e,n,o){return{code:r,size:t,name:e,resolvable:!!n,path:!!o}}function F(r){if(typeof r=="number"){if(ho[r]!=null)return ho[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(Pe[r]!=null)return Pe[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}var Lp=F("ip4"),Up=F("ip6"),Rp=F("ipcidr");function go(r,t){switch(F(r).code){case 4:case 41:return Mu(t);case 42:return yo(t);case 43:return H(t,"base10");case 6:case 273:case 33:case 132:return gi(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return yo(t);case 421:return zu(t);case 444:return yi(t);case 445:return yi(t);case 466:return Vu(t);case 481:return globalThis.encodeURIComponent(yo(t));default:return H(t,"base16")}}function bo(r,t){switch(F(r).code){case 4:return mi(t);case 41:return mi(t);case 42:return mo(t);case 43:return j(t,"base10");case 6:case 273:case 33:case 132:return xo(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return mo(t);case 421:return qu(t);case 444:return Fu(t);case 445:return Gu(t);case 466:return Hu(t);case 481:return mo(globalThis.decodeURIComponent(t));default:return j(t,"base16")}}var po=Object.values(Ve).map(r=>r.decoder),Ou=function(){let r=po[0].or(po[1]);return po.slice(2).forEach(t=>r=r.or(t)),r}();function mi(r){if(!Dr(r))throw new Error("invalid ip address");return lo(r)}function Mu(r){let t=pi(r,0,r.length);if(t==null)throw new Error("ipBuff is required");if(!Dr(t))throw new Error("invalid ip address");return t}function xo(r){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,r),new Uint8Array(t)}function gi(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function mo(r){let t=j(r),e=Uint8Array.from(Pt(t.length));return Et([e,t],e.length+t.length)}function yo(r){let t=le(r);if(r=r.slice(xt(t)),r.length!==t)throw new Error("inconsistent lengths");return H(r)}function qu(r){let t;r[0]==="Q"||r[0]==="1"?t=oe(W.decode(`z${r}`)).bytes:t=it.parse(r).multihash.bytes;let e=Uint8Array.from(Pt(t.length));return Et([e,t],e.length+t.length)}function Hu(r){let t=Ou.decode(r),e=Uint8Array.from(Pt(t.length));return Et([e,t],e.length+t.length)}function Vu(r){let t=le(r),e=r.slice(xt(t));if(e.length!==t)throw new Error("inconsistent lengths");return"u"+H(e,"base64url")}function zu(r){let t=le(r),e=r.slice(xt(t));if(e.length!==t)throw new Error("inconsistent lengths");return H(e,"base58btc")}function Fu(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let e=_t.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=xo(n);return Et([e,o],e.length+o.length)}function Gu(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let e=_t.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=xo(n);return Et([e,o],e.length+o.length)}function yi(r){let t=r.slice(0,r.length-2),e=r.slice(r.length-2),n=H(t,"base32"),o=gi(e);return`${n}:${o}`}function bi(r){r=wo(r);let t=[],e=[],n=null,o=r.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=F(i);if(a.size===0){t.push([a.code]),e.push([a.code]);continue}if(s++,s>=o.length)throw new _r("invalid address: "+r);if(a.path===!0){n=wo(o.slice(s).join("/")),t.push([a.code,bo(a.code,n)]),e.push([a.code,n]);break}let c=bo(a.code,o[s]);t.push([a.code,c]),e.push([a.code,go(a.code,c)])}return{string:xi(e),bytes:Kr(t),tuples:t,stringTuples:e,path:n}}function Eo(r){let t=[],e=[],n=null,o=0;for(;o<r.length;){let s=le(r,o),i=xt(s),a=F(s),c=Zu(a,r.slice(o+i));if(c===0){t.push([s]),e.push([s]),o+=i;continue}let f=r.slice(o+i,o+i+c);if(o+=c+i,o>r.length)throw new _r("Invalid address Uint8Array: "+H(r,"base16"));t.push([s,f]);let u=go(s,f);if(e.push([s,u]),a.path===!0){n=u;break}}return{bytes:Uint8Array.from(r),string:xi(e),tuples:t,stringTuples:e,path:n}}function xi(r){let t=[];return r.map(e=>{let n=F(e[0]);return t.push(n.name),e.length>1&&e[1]!=null&&t.push(e[1]),null}),wo(t.join("/"))}function Kr(r){return Et(r.map(t=>{let e=F(t[0]),n=Uint8Array.from(Pt(e.code));return t.length>1&&t[1]!=null&&(n=Et([n,t[1]])),n}))}function Zu(r,t){if(r.size>0)return r.size/8;if(r.size===0)return 0;{let e=le(t instanceof Uint8Array?t:Uint8Array.from(t));return e+xt(e)}}function wo(r){return"/"+r.trim().split("/").filter(t=>t).join("/")}var _r=class extends Error{static name="ParseError";name="ParseError";constructor(t){super(`Error parsing address: ${t}`)}};var $u=Symbol.for("nodejs.util.inspect.custom"),vo=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Yu=[F("dns").code,F("dns4").code,F("dns6").code,F("dnsaddr").code],So=class extends Error{constructor(t="No available resolver"){super(t),this.name="NoAvailableResolverError"}},kr=class r{bytes;#e;#t;#r;#n;[vo]=!0;constructor(t){t==null&&(t="");let e;if(t instanceof Uint8Array)e=Eo(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);e=bi(t)}else if(Ei(t))e=Eo(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=e.bytes,this.#e=e.string,this.#t=e.tuples,this.#r=e.stringTuples,this.#n=e.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let t,e,n,o,s="",i=F("tcp"),a=F("udp"),c=F("ip4"),f=F("ip6"),u=F("dns6"),l=F("ip6zone");for(let[x,w]of this.stringTuples())x===l.code&&(s=`%${w??""}`),Yu.includes(x)&&(e=i.name==="tcp"?"tcp":"udp",o=443,n=`${w??""}${s}`,t=x===u.code?6:4),(x===i.code||x===a.code)&&(e=F(x).name==="tcp"?"tcp":"udp",o=parseInt(w??"")),(x===c.code||x===f.code)&&(e=F(x).name==="tcp"?"tcp":"udp",n=`${w??""}${s}`,t=x===f.code?6:4);if(t==null||e==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:e,port:o}}protos(){return this.#t.map(([t])=>Object.assign({},F(t)))}protoCodes(){return this.#t.map(([t])=>t)}protoNames(){return this.#t.map(([t])=>F(t).name)}tuples(){return this.#t.map(([t,e])=>e==null?[t]:[t,e])}stringTuples(){return this.#r.map(([t,e])=>e==null?[t]:[t,e])}encapsulate(t){return t=new r(t),new r(this.toString()+t.toString())}decapsulate(t){let e=t.toString(),n=this.toString(),o=n.lastIndexOf(e);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new r(n.slice(0,o))}decapsulateCode(t){let e=this.tuples();for(let n=e.length-1;n>=0;n--)if(e[n][0]===t)return new r(Kr(e.slice(0,n)));return this}getPeerId(){try{let t=[];this.stringTuples().forEach(([n,o])=>{n===Pe.p2p.code&&t.push([n,o]),n===Pe["p2p-circuit"].code&&(t=[])});let e=t.pop();if(e?.[1]!=null){let n=e[1];return n[0]==="Q"||n[0]==="1"?H(W.decode(`z${n}`),"base58btc"):H(it.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(t){return ut(this.bytes,t.bytes)}async resolve(t){let e=this.protos().find(s=>s.resolvable);if(e==null)return[this];let n=wi.get(e.name);if(n==null)throw new So(`no available resolver for ${e.name}`);return(await n(this,t)).map(s=>Xe(s))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let e=(t??this).protos();return!(e.length!==2||e[0].code!==4&&e[0].code!==41||e[1].code!==6&&e[1].code!==273)}[$u](){return`Multiaddr(${this.#e})`}};var wi=new Map;function Ei(r){return!!r?.[vo]}function Xe(r){return new kr(r)}var Si="libp2p-peer-record",vi=Uint8Array.from([3,1]);var Je;(function(r){let t;(function(n){let o;n.codec=()=>(o==null&&(o=zt((s,i,a={})=>{a.lengthDelimited!==!1&&i.fork(),s.multiaddr!=null&&s.multiaddr.byteLength>0&&(i.uint32(10),i.bytes(s.multiaddr)),a.lengthDelimited!==!1&&i.ldelim()},(s,i,a={})=>{let c={multiaddr:at(0)},f=i==null?s.len:s.pos+i;for(;s.pos<f;){let u=s.uint32();switch(u>>>3){case 1:{c.multiaddr=s.bytes();break}default:{s.skipType(u&7);break}}}return c})),o),n.encode=s=>Vt(s,n.codec()),n.decode=(s,i)=>Ht(s,n.codec(),i)})(t=r.AddressInfo||(r.AddressInfo={}));let e;r.codec=()=>(e==null&&(e=zt((n,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(o.uint32(10),o.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(o.uint32(16),o.uint64(n.seq)),n.addresses!=null)for(let i of n.addresses)o.uint32(26),r.AddressInfo.codec().encode(i,o);s.lengthDelimited!==!1&&o.ldelim()},(n,o,s={})=>{let i={peerId:at(0),seq:0n,addresses:[]},a=o==null?n.len:n.pos+o;for(;n.pos<a;){let c=n.uint32();switch(c>>>3){case 1:{i.peerId=n.bytes();break}case 2:{i.seq=n.uint64();break}case 3:{if(s.limits?.addresses!=null&&i.addresses.length===s.limits.addresses)throw new xr('Decode error - map field "addresses" had too many elements');i.addresses.push(r.AddressInfo.codec().decode(n,n.uint32(),{limits:s.limits?.addresses$}));break}default:{n.skipType(c&7);break}}}return i})),e),r.encode=n=>Vt(n,r.codec()),r.decode=(n,o)=>Ht(n,r.codec(),o)})(Je||(Je={}));var Or=class r{static createFromProtobuf=t=>{let e=Je.decode(t),n=ii(oe(e.peerId)),o=(e.addresses??[]).map(i=>Xe(i.multiaddr)),s=e.seq;return new r({peerId:n,multiaddrs:o,seqNumber:s})};static DOMAIN=Si;static CODEC=vi;peerId;multiaddrs;seqNumber;domain=r.DOMAIN;codec=r.CODEC;marshaled;constructor(t){let{peerId:e,multiaddrs:n,seqNumber:o}=t;this.peerId=e,this.multiaddrs=n??[],this.seqNumber=o??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=Je.encode({peerId:this.peerId.toMultihash().bytes,seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))})),this.marshaled}equals(t){return!(!(t instanceof r)||!this.peerId.equals(t.peerId)||this.seqNumber!==t.seqNumber||!ai(this.multiaddrs,t.multiaddrs))}};return Ki(ju);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerRecord}));
